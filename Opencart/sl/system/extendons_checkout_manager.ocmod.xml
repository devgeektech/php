<?xml version="1.0" encoding="UTF-8"?>
<modification>
    <name><![CDATA[<font color="#19a3f2"><b>Extendons - Checkout Fields Manager</b></font>]]></name>
	<id>extendons-checkout-fields-manager</id>
    <version><![CDATA[<b>1.3</b>]]></version>
    <author><![CDATA[<b>Extendons</b>]]> (info@extendons.com)</author>
	<link>https://extendons.com</link>
    <code>extendons-checkout-fields-manager</code>

<!-- ************************************************                    ****************************************************** -->
<!-- ================================================ VERSION == 3.0.x   ====================================================== -->
<!-- ************************************************                    ****************************************************** -->


<!-- ************************ -->
<!-- ADMIN -->
<!-- ************************ -->


	<!-- ************************ -->
	<!-- CONTROLLER -->
	<!-- ************************ -->
	    <!-- MENU - CONTROLLER -->
	    <file path="admin/controller/common/column_left.php">
			<operation>
			    <search><![CDATA[// Users]]></search>
			    <add position="before"><![CDATA[
					// Extendons Checkout Fields Manager
						$checkoutFieldsManager = array();

						if ($this->user->hasPermission('access', 'extension/module/checkout_manager/custom')) {

							$checkoutFieldsManager[] = array(
								'name'	   => $this->language->get('text_checkout_custom_fields'),
								'href'     => $this->url->link('extension/module/checkout_manager/custom', 'user_token=' . $this->session->data['user_token'], true),
								'children' => array()
							);
						}

						if ($this->user->hasPermission('access', 'extension/module/checkout_manager/checkout')) {
							$checkoutFieldsManager[] = array(
								'name'	   => $this->language->get('text_checkout_default_fields'),
								'href'     => $this->url->link('extension/module/checkout_manager/checkout', 'user_token=' . $this->session->data['user_token'], true),
								'children' => array()
							);
						}
						// move under system menu
						if ($checkoutFieldsManager) {
							$system[] = array(
								'id'       => 'menu-checkout-fields-manager',
								'img'	   => 'view/image/extendons.png',
								'icon'	   => 'fa-etsy',
								'name'	   => $this->language->get('text_extendons_cfm'),
								'href'     => '',
								'children' => $checkoutFieldsManager
							);
						}

					// Extendons Checkout Fields Manager /- END
				]]></add>
			</operation>
	    </file>

	    <!-- CUSTOMER / CUSTOMER - CONTROLLER -->
	    <file path="admin/controller/customer/customer.php">
			<operation>
			    <search><![CDATA[$this->model_customer_customer->editCustomer($this->request->get['customer_id'], $this->request->post);]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

			        if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$this->model_extension_checkout_manager_checkout->editCustomerAddress($this->request->get['customer_id'], $this->request->post);
					}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search index="1"><![CDATA[$data['header'] = $this->load->controller('common/header');]]></search>
			    <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
			        if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager'))
			        {
						if ($this->request->server['REQUEST_METHOD'] == 'POST')
						{
							foreach ($data['addresses'] as $key => $value) {
								$myCustomFields = $this->model_extension_checkout_manager_checkout->getFields();

								// this array will return and again create custom fields dynamically when user submit form and he got some error or empty required fields
								$data['addresses'][$key]['post_my_custom_fields'] = $myCustomFields;

								// we need this array to generate custom fields, when user want to add new address by clicking add new
								$data['add_my_custom_fields'] = $myCustomFields;
							}

						} else if (!isset($this->request->get['customer_id']) && ($this->request->server['REQUEST_METHOD'] != 'POST')) {

							// when user want to add new customer and here we are sending this array to generate our custom fields as well by clicking on add new
							$data['add_my_custom_fields'] = $this->model_extension_checkout_manager_checkout->getFields();

						} else if (isset($this->request->get['customer_id']) && ($this->request->server['REQUEST_METHOD'] != 'POST')) {

							// when user want to edit existing customer and here we are sending this array to generate our custom fields as well by clicking on add new
							$data['add_my_custom_fields'] = $this->model_extension_checkout_manager_checkout->getFields();
						}
					}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA[if (($custom_field['location'] == 'address') && $custom_field['required'] && empty($value['custom_field'][$custom_field['custom_field_id']])) {]]></search>
			    <add offset="5" position="after"><![CDATA[
	            // Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

			        if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager'))
			        {
						// validate my custom fields
						if (isset($value['my_custom_fields'])) {

							foreach ($value['my_custom_fields'] as $key2 => $mcf) {

								$get_f_condition = $this->db->query("SELECT field_label, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $key2 . "' AND field_condition = 'required' ");

								if ($get_f_condition->num_rows) {
									$f_name = $get_f_condition->row['field_label'];

									if (empty($mcf) || $mcf == 'required') {
										$this->error['address'][$key]['my_custom_fields_errors'][$key2] = $f_name.' is required!';
									}
								}
							}
						}
					}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>
	    </file>

	    <!-- SALE/ORDER - CONTROLLER -->
	    <file path="admin/controller/sale/order.php">
			<operation>
			    <search index="0"><![CDATA[if ($order_info) {]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					if (!empty($order_info['additional_custom_fields_info'])) {
						foreach ($order_info['additional_custom_fields_info'] as $key => $more_info) {

								$get_label = $this->db->query("SELECT field_label FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $more_info['meta_key'] . "' ");

								if ($get_label->num_rows) {

									$title = $get_label->row['field_label'];

									$value = @unserialize($more_info['meta_value']);
									if ($value != true) {
										$value = $more_info['meta_value'];
									}

									if ($more_info['checkout_section'] == 'shipping_address') {
										$shipping_address[$key]['meta_key'] = $title;
										$shipping_address[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Address Custom Fields'] = $shipping_address;
									}

									if ($more_info['checkout_section'] == 'payment_address') {
										$payment_address[$key]['meta_key'] = $title;
										$payment_address[$key]['meta_value'] = $value;
										$addressMoreInfo['Payment Address Custom Fields'] = $payment_address;
									}

									if ($more_info['checkout_section'] == 'payment_method') {
										$payment_method[$key]['meta_key'] = $title;
										$payment_method[$key]['meta_value'] = $value;
										$addressMoreInfo['Payment Method Custom Fields'] = $payment_method;
									}

									if ($more_info['checkout_section'] == 'shipping_method') {
										$shipping_method[$key]['meta_key'] = $title;
										$shipping_method[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Method Custom Fields'] = $shipping_method;
									}
								}
						} // endforeach

		        		$data['additional_custom_fields_info'] = $addressMoreInfo;
					} // endif
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search index="4"><![CDATA[if ($order_info) {]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					if (!empty($order_info['additional_custom_fields_info'])) {
						foreach ($order_info['additional_custom_fields_info'] as $key => $more_info) {

								$get_label = $this->db->query("SELECT field_label FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $more_info['meta_key'] . "' ");

								if ($get_label->num_rows) {

									$title = $get_label->row['field_label'];

									$value = @unserialize($more_info['meta_value']);
									if ($value != true) {
										$value = $more_info['meta_value'];
									}

									if ($more_info['checkout_section'] == 'shipping_address') {
										$shipping_address[$key]['meta_key'] = $title;
										$shipping_address[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Address Custom Fields'] = $shipping_address;
									}

									if ($more_info['checkout_section'] == 'payment_address') {
										$payment_address[$key]['meta_key'] = $title;
										$payment_address[$key]['meta_value'] = $value;
										$addressMoreInfo['Payment Address Custom Fields'] = $payment_address;
									}

									if ($more_info['checkout_section'] == 'payment_method') {
										$payment_method[$key]['meta_key'] = $title;
										$payment_method[$key]['meta_value'] = $value;
										$addressMoreInfo['Payment Method Custom Fields'] = $payment_method;
									}

									if ($more_info['checkout_section'] == 'shipping_method') {
										$shipping_method[$key]['meta_key'] = $title;
										$shipping_method[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Method Custom Fields'] = $shipping_method;
									}
								}
						} // endforeach

		        		$data['additional_custom_fields_info'] = $addressMoreInfo;
					} // endif
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA[if ($order_info && $order_info['shipping_code']) {]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					if (!empty($order_info['additional_custom_fields_info'])) {
						foreach ($order_info['additional_custom_fields_info'] as $key => $more_info) {

								$get_label = $this->db->query("SELECT field_label FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $more_info['meta_key'] . "' ");

								if ($get_label->num_rows) {

									$title = $get_label->row['field_label'];

									$value = @unserialize($more_info['meta_value']);
									if ($value != true) {
										$value = $more_info['meta_value'];
									}

									if ($more_info['checkout_section'] == 'shipping_address') {
										$shipping_address[$key]['meta_key'] = $title;
										$shipping_address[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Address Custom Fields'] = $shipping_address;
									}

									if ($more_info['checkout_section'] == 'shipping_method') {
										$shipping_method[$key]['meta_key'] = $title;
										$shipping_method[$key]['meta_value'] = $value;
										$addressMoreInfo['Shipping Method Custom Fields'] = $shipping_method;
									}
								}
						} // endforeach

		        		$data['additional_custom_fields_info'] = $addressMoreInfo;
					} // endif
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>
	    </file>

	<!-- ************************ -->
	<!-- MODEL -->
	<!-- ************************ -->

	    <!-- CUSTOMER / CUSTOMER - MODEL -->
	    <file path="admin/model/customer/customer.php">
			<operation>
			    <search index="0"><![CDATA[$address_id = $this->db->getLastId();]]></search>
			    <add position="after" offset="3"><![CDATA[
	            // Extendons - Checkout Manager
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {

						$address_id = isset($address_id) ? $address_id : $this->db->getLastId();

						$this->db->query("INSERT INTO " . DB_PREFIX . "extendons_checkout_fields_data SET address_id = '" . (int)$address_id . "', customer_id = '" . (int)$customer_id . "', firstname = '" . $this->db->escape($address['firstname']) . "', lastname = '" . $this->db->escape($address['lastname']) . "', company = '" . $this->db->escape($address['company']) . "', address_1 = '" . $this->db->escape($address['address_1']) . "', address_2 = '" . $this->db->escape($address['address_2']) . "', city = '" . $this->db->escape($address['city']) . "', postcode = '" . $this->db->escape($address['postcode']) . "', country_id = '" . (int)$address['country_id'] . "', zone_id = '" . (int)$address['zone_id'] . "', custom_field = '" . $this->db->escape(isset($address['custom_field']) ? json_encode($address['custom_field']) : json_encode(array())) . "', `created_at` = NOW(), `updated_at` = NOW()");

						// get custom address last id
						$db_data_id = $this->db->getLastId();

						// Insert custom field with value into column table
			            if (isset($address['my_custom_fields']) && !empty($address['my_custom_fields'])) {
			                foreach ($address['my_custom_fields'] as $field_key => $meta_value) {

		                        // serialize if custom field value is an array
		                        if (is_array($meta_value)) {
		                            $meta_value = serialize($meta_value);
		                        }

		                        // get custom created field id & store it in columns table as well
		                        $custom_field = $this->db->query("SELECT db_field_id FROM " . DB_PREFIX . "extendons_checkout_fields WHERE `field_name` = '" . $field_key . "' ");

		                        // field id
		                        $db_field_id = $custom_field->row['db_field_id'];

		                        $this->db->query("INSERT INTO " . DB_PREFIX . "extendons_checkout_fields_data_columns SET `db_field_id` = '" . $db_field_id . "', `db_data_id` = '" . $db_data_id . "', `customer_id` = '" . (int)$customer_id . "', `meta_key` = '" . $field_key . "', `meta_value` = '" . $meta_value . "' ");
			                }
			            }
		        	}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA[$this->db->query("DELETE FROM " . DB_PREFIX . "customer_ip WHERE customer_id = '" . (int)$customer_id . "'");]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
						$this->db->query("DELETE FROM " . DB_PREFIX . "extendons_checkout_fields_data WHERE customer_id = '" . (int)$customer_id . "'");
						$this->db->query("DELETE FROM " . DB_PREFIX . "extendons_checkout_fields_data_columns WHERE customer_id = '" . (int)$customer_id . "'");
		        	}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA[return array(]]></search>
			    <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
					$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
	            		$getIDofCustomAddress = $this->db->query("SELECT db_data_id FROM " . DB_PREFIX . "extendons_checkout_fields_data WHERE address_id = '" . $address_id . "' ");

						if ($getIDofCustomAddress->num_rows)
						{
							// my custom address id
							$my_custom_address_id = $getIDofCustomAddress->row['db_data_id'];

							// get all input fields with status = 1
							$getAllFieldsID = $this->db->query("SELECT db_field_id FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_existance = 'custom' ORDER BY field_sort_order");

							// loop through all input fields
							foreach ($getAllFieldsID->rows as $value)
							{
								$db_field_id = $value['db_field_id'];

								// get single input field using its id
								$getSingleFieldByID = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND db_field_id = " . $db_field_id);

								$field_to_show = @unserialize($getSingleFieldByID->row['field_to_show']);
								$field_visibility = @unserialize($getSingleFieldByID->row['field_visibility']);

								if ($field_to_show == true) {
									$getSingleFieldByID->row['field_to_show'] = $field_to_show;
								}
								if ($field_visibility == true) {
									$getSingleFieldByID->row['field_visibility'] = $field_visibility;
								}

								// if field has options
								$getSingleFieldByID_options = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields_options WHERE db_field_id = " . $db_field_id);

								$getSingleFieldByID->row['field_options'] = array();

								// if field_options exists
								if ($getSingleFieldByID_options->num_rows) {
									$getSingleFieldByID->row['field_options'] = $getSingleFieldByID_options->rows;
								}

								$custom_address_meta_q = $this->db->query("SELECT * FROM
														" . DB_PREFIX . "extendons_checkout_fields_data_columns ecfdc
														WHERE ecfdc.db_field_id = " . $db_field_id." AND ecfdc.db_data_id = " . $my_custom_address_id);

								$getSingleFieldByID->row['field_meta_data'] = array();
								if ($custom_address_meta_q->num_rows) {

									// this meta value is from column table
									$meta_value = @unserialize($custom_address_meta_q->row['meta_value']);
									if ($meta_value == true) {
										$custom_address_meta_q->row['meta_value'] = $meta_value;
									}

									$getSingleFieldByID->row['field_meta_data'] = $custom_address_meta_q->row;
								}

								$update_my_custom_address[] = $getSingleFieldByID->row;
							} // endforeach
						}
					}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA['custom_field'   => json_decode($address_query->row['custom_field'], true)]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					,'update_my_custom_address' => (isset($update_my_custom_address) && !empty($update_my_custom_address)) ? $update_my_custom_address : array()
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>
	    </file>

	    <!-- SALE / ORDER - MODEL -->
	    <file path="admin/model/sale/order.php">
			<operation>
			    <search><![CDATA[return array(]]></search>
			    <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
	            	$additional_custom_fields_info = array();
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
						$additional_custom_fields_info = $this->db->query("SELECT meta_key, meta_value, checkout_section FROM `" . DB_PREFIX . "extendons_checkout_fields_order` WHERE  order_id = '" . (int)$order_id . "'");
						$additional_custom_fields_info = $additional_custom_fields_info->rows;
		        	}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

			<operation>
			    <search><![CDATA['date_modified'           => $order_query->row['date_modified']]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					,'additional_custom_fields_info'		  => $additional_custom_fields_info
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>
	    </file>

	<!-- ************************ -->
	<!-- LANGUAGE -->
	<!-- ************************ -->

	    <!-- MENU - LANGUAGE -->
	    <file path="admin/language/*/common/column_left.php">
			<operation>
			    <search><![CDATA[// Text]]></search>
			    <add position="after"><![CDATA[
				// Extendons Checkout Manager
				    $_['text_extendons_cfm']        	= 'Extendons Checkout Fields';
				    $_['text_checkout_custom_fields']  	= 'Custom Checkout Fields';
				    $_['text_checkout_default_fields']  = 'Default Checkout Fields';
	        	// Extendons - Checkout Manager /- END
				]]></add>
			</operation>
	    </file>

	<!-- ************************ -->
	<!-- VIEW -->
	<!-- ************************ -->

	    <!-- HEADER - VIEW -->
	    <file path="admin/view/template/common/header.twig">
	        <operation>
	            <search><![CDATA[<link type="text/css" href="view/stylesheet/stylesheet.css" rel="stylesheet" media="screen" />]]></search>
	            <add position="before"><![CDATA[
	            	<!-- Extendons - Checkout Manager -->
		    		<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
					<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
	            	<!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SALE / ORDER_INFO - VIEW -->
	    <file path="admin/view/template/sale/order_info.twig">
	        <operation>
	            <search index="0"><![CDATA[{% if shipping_method %}]]></search>
	            <add position="before"><![CDATA[
		        <!-- Extendons - Checkout Manager -->
	                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                	<tr><td colspan="2">
		                    {% if (additional_custom_fields_info['Payment Method Custom Fields'] is defined and additional_custom_fields_info['Payment Method Custom Fields'] is not empty) %}
		                        <table class="table table-bordered">
		                            <thead>
		                                <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Payment Method Custom Fields' }}</td></tr>
		                            </thead>
		                            <tbody>
		                                <tr><td>
		                                    {% for result in additional_custom_fields_info['Payment Method Custom Fields'] %}
		                                        {% if result is not empty %}
		                                            <b>{{ result['meta_key'] }} : </b>
	                                                {% if result['meta_value'] is iterable %}
	                                                        {% for val in result['meta_value'] %}
	                                                            {{ val|capitalize ~ ', ' }}
	                                                        {% endfor %}
	                                                {% else %}
	                                                        {{ result['meta_value']|capitalize }}
	                                                {% endif %}
	                                                <br />
		                                        {% endif %}
		                                    {% endfor %}
		                                </td></tr>
		                            </tbody>
		                        </table>
		                    {% endif %}
	                	</td></tr>
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="0"><![CDATA[{% if shipping_method %}]]></search>
	            <add position="after" offset="5"><![CDATA[
		        <!-- Extendons - Checkout Manager -->
	                {% if (additional_custom_fields_info['Shipping Method Custom Fields'] and additional_custom_fields_info['Shipping Method Custom Fields'] is not empty) %}
	                	<tr><td colspan="2">
	                        <table class="table table-bordered">
	                            <thead>
	                                <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Shipping Method Custom Fields' }}</td></tr>
	                            </thead>
	                            <tbody>
	                                <tr><td>
	                                    {% for result in additional_custom_fields_info['Shipping Method Custom Fields'] %}
	                                        {% if result is not empty %}
	                                            <b>{{ result['meta_key'] }} : </b>
	                                            {% if result['meta_value'] is iterable %}
	                                                    {% for val in result['meta_value'] %}
	                                                        {{ val|capitalize ~ ', ' }}
	                                                    {% endfor %}
	                                            {% else %}
	                                                    {{ result['meta_value']|capitalize }}
	                                            {% endif %}
	                                            <br />
	                                        {% endif %}
	                                    {% endfor %}
	                                </td></tr>
	                            </tbody>
	                        </table>
	                	</td></tr>
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<td class="text-left">{{ payment_address }}</td>]]></search>
	            <add position="replace"><![CDATA[
		        <!-- Extendons - Checkout Manager -->
	                <td class="text-left"><div style="margin-bottom: 10px;">{{ payment_address }}</div>
	                    {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                        {% for key_name, insideArr in additional_custom_fields_info %}
	                            {% if (key_name == 'Payment Address Custom Fields') %}
	                                <table class="table table-bordered">
	                                    <thead>
	                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                    </thead>
	                                    <tbody>
	                                        <tr><td>
	                                            {% for result in insideArr %}
	                                                {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
	                                                {% endif %}
	                                            {% endfor %}
	                                        </td></tr>
	                                    </tbody>
	                                </table>
	                            {% endif %}
	                        {% endfor %}
	                    {% endif %}
	                </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="2"><![CDATA[{% if shipping_method %}]]></search>
	            <add position="replace" offset="2"><![CDATA[
		        <!-- Extendons - Checkout Manager -->
	                {% if shipping_method %}
	                    <td class="text-left"><div style="margin-bottom: 10px;">{{ shipping_address }}</div>
	                		{% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
		                        {% for key_name, insideArr in additional_custom_fields_info %}
		                            {% if (key_name == 'Shipping Address Custom Fields') %}
		                                <table class="table table-bordered">
		                                    <thead>
		                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
		                                    </thead>
		                                    <tbody>
		                                        <tr><td>
		                                            {% for result in insideArr %}
		                                                {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
		                                                {% endif %}
		                                            {% endfor %}
		                                        </td></tr>
		                                    </tbody>
		                                </table>
		                            {% endif %}
		                        {% endfor %}
		                	{% endif %}
	                    </td>
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SALE / ORDER_INVOICE - VIEW -->
	    <file path="admin/view/template/sale/order_invoice.twig">
	        <operation>
	            <search><![CDATA[<b>{{ text_payment_method }}</b> {{ order.payment_method }}<br />]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <div style="margin-bottom: 10px;"><b>{{ text_payment_method }}</b> {{ order.payment_method }}</div>

	                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                    {% for key_name, insideArr in additional_custom_fields_info %}
	                        {% if (key_name == 'Payment Method Custom Fields') %}
	                            <table class="table table-bordered">
	                                <thead>
	                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                </thead>
	                                <tbody>
	                                    <tr><td>
	                                        {% for result in insideArr %}
	                                            {% if result is not empty %}
		                                                <b>{{ result['meta_key'] }} : </b>
		                                                {% if result['meta_value'] is iterable %}
		                                                        {% for val in result['meta_value'] %}
		                                                            {{ val|capitalize ~ ', ' }}
		                                                        {% endfor %}
		                                                {% else %}
		                                                        {{ result['meta_value']|capitalize }}
		                                                {% endif %}
		                                                <br />
	                                            {% endif %}
	                                        {% endfor %}
	                                    </td></tr>
	                                </tbody>
	                            </table>
	                        {% endif %}
	                    {% endfor %}
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<b>{{ text_shipping_method }}</b> {{ order.shipping_method }}<br />]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <div style="margin-bottom: 10px;"><b>{{ text_shipping_method }}</b> {{ order.shipping_method }}</div>

	                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                    {% for key_name, insideArr in additional_custom_fields_info %}
	                        {% if (key_name == 'Shipping Method Custom Fields') %}
	                            <table class="table table-bordered">
	                                <thead>
	                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                </thead>
	                                <tbody>
	                                    <tr><td>
	                                        {% for result in insideArr %}
	                                            {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
	                                            {% endif %}
	                                        {% endfor %}
	                                    </td></tr>
	                                </tbody>
	                            </table>
	                        {% endif %}
	                    {% endfor %}
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="0"><![CDATA[<td><address>]]></search>
	            <add position="replace" offset="2"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <td><address>{{ order['payment_address'] }}</address>
	                    {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                        {% for key_name, insideArr in additional_custom_fields_info %}
	                            {% if (key_name == 'Payment Address Custom Fields') %}
	                                <table class="table table-bordered" style="margin-top: -9px;">
	                                    <thead>
	                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                    </thead>
	                                    <tbody>
	                                        <tr><td>
	                                            {% for result in insideArr %}
	                                                {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
	                                                {% endif %}
	                                            {% endfor %}
	                                        </td></tr>
	                                    </tbody>
	                                </table>
	                            {% endif %}
	                        {% endfor %}
	                    {% endif %}
	                </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="1"><![CDATA[<td><address>]]></search>
	            <add position="replace" offset="2"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <td><address>{{ order['shipping_address'] }}</address>
	                    {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                        {% for key_name, insideArr in additional_custom_fields_info %}
	                            {% if (key_name == 'Shipping Address Custom Fields') %}
	                                <table class="table table-bordered" style="margin-top: -9px;">
	                                    <thead>
	                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                    </thead>
	                                    <tbody>
	                                        <tr><td>
	                                            {% for result in insideArr %}
	                                                {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
	                                                {% endif %}
	                                            {% endfor %}
	                                        </td></tr>
	                                    </tbody>
	                                </table>
	                            {% endif %}
	                        {% endfor %}
	                    {% endif %}
	                </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SALE / ORDER_SHIPPING - VIEW -->
	    <file path="admin/view/template/sale/order_shipping.twig">

	        <operation>
	            <search><![CDATA[<b>{{ text_shipping_method }}</b> {{ order.shipping_method }}<br />]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <div style="margin-bottom: 10px;"><b>{{ text_shipping_method }}</b> {{ order.shipping_method }}</div>

	                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                    {% for key_name, insideArr in additional_custom_fields_info %}
	                        {% if (key_name == 'Shipping Method Custom Fields') %}
	                            <table class="table table-bordered">
	                                <thead>
	                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ key_name }}</td></tr>
	                                </thead>
	                                <tbody>
	                                    <tr><td>
	                                        {% for result in insideArr %}
	                                            {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
	                                            {% endif %}
	                                        {% endfor %}
	                                    </td></tr>
	                                </tbody>
	                            </table>
	                        {% endif %}
	                    {% endfor %}
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<td>{{ order.shipping_address }}</td>]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <td><address>{{ order.shipping_address }}</address>
		                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                        {% if (additional_custom_fields_info['Shipping Address Custom Fields'] and additional_custom_fields_info['Shipping Address Custom Fields'] is not empty) %}
	                            <table class="table table-bordered">
	                                <thead>
	                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Shipping Address Custom Fields' }}</td></tr>
	                                </thead>
	                                <tbody>
	                                    <tr><td>
	                                        {% for result in additional_custom_fields_info['Shipping Address Custom Fields'] %}
	                                            {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
	                                            {% endif %}
	                                        {% endfor %}
	                                    </td></tr>
	                                </tbody>
	                            </table>
	                        {% endif %}
	                    {% endif %}
	                </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CUSTOMER / CUSTOMER FORM - VIEW -->
	    <file path="admin/view/template/customer/customer_form.twig">
	        <operation>
	            <search><![CDATA[<label class="radio">{% if address.address_id == address_id or not addresses %}]]></search>
	            <add position="before" offset="3"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                {% if address.update_my_custom_address %}
	                    {% for myCustom in address.update_my_custom_address %}
	                        <!-- {{ myCustom.field_meta_data['meta_value'] }} -->
	                        {% if myCustom.field_input_type == 'text' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="text"
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        value="{{ myCustom.field_meta_data ? myCustom.field_meta_data['meta_value'] : '' }}"
	                                        placeholder="{{ myCustom.field_placeholder }}"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    />
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'date' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group date">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            value="{{ myCustom.field_meta_data ? myCustom.field_meta_data['meta_value'] : '' }}"
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="YYYY-MM-DD"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'time' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group time">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            value="{{ myCustom.field_meta_data ? myCustom.field_meta_data['meta_value'] : '' }}"
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="HH:mm"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'datetime' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group datetime">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            value="{{ myCustom.field_meta_data ? myCustom.field_meta_data['meta_value'] : '' }}"
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="YYYY-MM-DD HH:mm"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'textarea' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <textarea
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        placeholder="{{ myCustom.field_placeholder }}"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >{{ myCustom.field_meta_data ? myCustom.field_meta_data['meta_value'] : '' }}</textarea>
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'radio' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    {% if myCustom.field_options %}
	                                        {% for option in myCustom.field_options %}
	                                            <div class="radio">
	                                                <label>
	                                                    <input type="radio"
	                                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                                        value="{{ option.op_value }}"
	                                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                                        {{ (myCustom.field_meta_data and myCustom.field_meta_data['meta_value'] == option.op_value) ? "checked='checked'" : '' }}
	                                                    /> {{ option.op_name }}
	                                                </label>
	                                            </div>
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'checkbox' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    {% if myCustom.field_options %}
	                                        {% for option in myCustom.field_options %}
	                                            <div class="checkbox">
	                                                <label>
	                                                    <input type="checkbox"
	                                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]"
	                                                        value="{{ option.op_value }}"
	                                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"

	                                                        {% if ( myCustom.field_meta_data ) %}
	                                                            {% if myCustom.field_meta_data['meta_key'] == myCustom.field_name %}
	                                                                {% if ( myCustom.field_meta_data['meta_value'] is not empty and myCustom.field_meta_data['meta_value'] is iterable ) %}
	                                                                    {% for k, v in myCustom.field_meta_data['meta_value'] %}
	                                                                        {% if (v == option.op_value) %}
	                                                                            checked="checked"
	                                                                        {% endif %}
	                                                                    {% endfor %}
	                                                                {% endif %}
	                                                            {% endif %}
	                                                        {% endif %}
	                                                    /> {{ option.op_name }}
	                                                </label>
	                                            </div>
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'select' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <select
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if myCustom.field_options %}
	                                            {% for option in myCustom.field_options %}
	                                                <option value="{{ option.op_value }}" {{ (myCustom.field_meta_data and myCustom.field_meta_data['meta_value'] == option.op_value) ? "selected='selected'" : '' }}>{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select>
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'multi-select' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    <select multiple="multiple"
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if myCustom.field_options %}
	                                            {% for option in myCustom.field_options %}
	                                                <option value="{{ option.op_value }}"
	                                                {% if ( myCustom.field_meta_data ) %}
	                                                    {% if myCustom.field_meta_data['meta_key'] == myCustom.field_name %}
	                                                        {% if ( myCustom.field_meta_data['meta_value'] is not empty and myCustom.field_meta_data['meta_value'] is iterable ) %}
	                                                            {% for k, v in myCustom.field_meta_data['meta_value'] %}
	                                                                {% if (v == option.op_value) %}
	                                                                    selected="selected"
	                                                                {% endif %}
	                                                            {% endfor %}
	                                                        {% endif %}
	                                                    {% endif %}
	                                                {% endif %}
	                                                >{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select>
	                                </div>
	                            </div>
	                        {% endif %}

	                    {% endfor %}
	                {% elseif address.post_my_custom_fields %}
	                    {% for myCustom in address.post_my_custom_fields %}
	                        <!-- {{ myCustom.field_meta_data['meta_value'] }} -->
	                        {% if myCustom.field_input_type == 'text' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="text"
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        {% for key, value in address.my_custom_fields %}
	                                            {% if key == myCustom.field_name %}
	                                                value="{{ value ? value : '' }}"
	                                            {% endif %}
	                                        {% endfor %}
	                                        placeholder="{{ myCustom.field_placeholder }}"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    />

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'date' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group date">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            {% for key, value in address.my_custom_fields %}
	                                                {% if key == myCustom.field_name %}
	                                                    value="{{ value ? value : '' }}"
	                                                {% endif %}
	                                            {% endfor %}
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="YYYY-MM-DD"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'time' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group time">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            {% for key, value in address.my_custom_fields %}
	                                                {% if key == myCustom.field_name %}
	                                                    value="{{ value ? value : '' }}"
	                                                {% endif %}
	                                            {% endfor %}
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="HH:mm"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'datetime' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <div class="input-group datetime">
	                                        <input type="text"
	                                            name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                            {% for key, value in address.my_custom_fields %}
	                                                {% if key == myCustom.field_name %}
	                                                    value="{{ value ? value : '' }}"
	                                                {% endif %}
	                                            {% endfor %}
	                                            placeholder="{{ myCustom.field_placeholder }}"
	                                            id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                            class="form-control"
	                                            data-date-format="YYYY-MM-DD HH:mm"
	                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
	                                    </div>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'textarea' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <textarea
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        placeholder="{{ myCustom.field_placeholder }}"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >{% for key, value in address.my_custom_fields %}{% if key == myCustom.field_name %}{{ value ? value : '' }}{% endif %}{% endfor %}</textarea>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'radio' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    {% if myCustom.field_options %}
	                                        {% for option in myCustom.field_options %}
	                                            <div class="radio">
	                                                <label>
	                                                    <input type="radio"
	                                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                                        value="{{ option.op_value }}"
	                                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                                        {% for key, value in address.my_custom_fields %}
	                                                            {% if key == myCustom.field_name %}
	                                                                {{ (value == option.op_value) ? 'checked="checked"' : '' }}
	                                                            {% endif %}
	                                                        {% endfor %}
	                                                    /> {{ option.op_name }}
	                                                </label>
	                                            </div>
	                                        {% endfor %}
	                                    {% endif %}

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'checkbox' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    {% if myCustom.field_options %}
	                                        {% for option in myCustom.field_options %}
	                                            <div class="checkbox">
	                                                <label>
	                                                    <input type="checkbox"
	                                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]"
	                                                        value="{{ option.op_value }}"
	                                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                                        {% for key, value in address.my_custom_fields %}
	                                                            {% if key == myCustom.field_name %}
	                                                                {% if (value is not empty and value is iterable) %}
	                                                                    {% for k, v in value %}
	                                                                        {% if (v == option.op_value) %}
	                                                                            checked="checked"
	                                                                        {% endif %}
	                                                                    {% endfor %}
	                                                                {% endif %}
	                                                            {% endif %}
	                                                        {% endfor %}
	                                                    /> {{ option.op_name }}
	                                                </label>
	                                            </div>
	                                        {% endfor %}
	                                    {% endif %}

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'select' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <select
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if myCustom.field_options %}
	                                            {% for option in myCustom.field_options %}
	                                                <option value="{{ option.op_value }}"
	                                                    {% for key, value in address.my_custom_fields %}
	                                                        {% if key == myCustom.field_name %}
	                                                            {{ (value == option.op_value) ? 'selected="selected"' : '' }}
	                                                        {% endif %}
	                                                    {% endfor %}
	                                                >{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                        {% if myCustom.field_input_type == 'multi-select' %}
	                            <div class="form-group {{ myCustom.field_condition }}">
	                                <label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == 'required' ? myCustom.field_condition : '' }}">

	                                    <select multiple="multiple"
	                                        name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]"
	                                        id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if myCustom.field_options %}
	                                            {% for option in myCustom.field_options %}
	                                                <option value="{{ option.op_value }}"
	                                                    {% for key, value in address.my_custom_fields %}
	                                                        {% if key == myCustom.field_name %}
	                                                            {% if (value is not empty and value is iterable) %}
	                                                                {% for k, v in value %}
	                                                                    {% if (v == option.op_value) %}
	                                                                        {{ 'selected="selected"' }}
	                                                                    {% endif %}
	                                                                {% endfor %}
	                                                            {% endif %}
	                                                        {% endif %}
	                                                    {% endfor %}
	                                                >{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select>

	                                    <!-- error -->
	                                    {% if error_address[address_row]['my_custom_fields_errors'] %}
	                                        {% for key, value in error_address[address_row]['my_custom_fields_errors'] %}
	                                            {% if key == myCustom.field_name %}
	                                                <div class="text-danger">{{ value }}</div>
	                                            {% endif %}
	                                        {% endfor %}
	                                    {% endif %}
	                                </div>
	                            </div>
	                        {% endif %}

	                    {% endfor %}
	                {% endif %}
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <!-- place in javascript of twig file -->
	        <operation>
	            <search><![CDATA[// Custom Fields]]></search>
	            <add position="after" offset="106"><![CDATA[
	            // Extendons - Checkout Manager
	                {% if add_my_custom_fields %}
				        {% for myCustom in add_my_custom_fields %}

				            {% if myCustom.field_input_type == 'text' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<input type="text" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="" placeholder="{{ myCustom.field_placeholder }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" />';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'date' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<div class="input-group date">';
				                            html += '<input type="text" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="" placeholder="{{ myCustom.field_placeholder }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" data-date-format="YYYY-MM-DD" /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>';
				                        html += '</div>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'time' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<div class="input-group time">';
				                            html += '<input type="text" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="" placeholder="{{ myCustom.field_placeholder }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" data-date-format="HH:mm" /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>';
				                        html += '</div>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'datetime' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<div class="input-group datetime">';
				                            html += '<input type="text" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="" placeholder="{{ myCustom.field_placeholder }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" data-date-format="YYYY-MM-DD HH:mm" /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>';
				                        html += '</div>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'textarea' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<textarea name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" placeholder="{{ myCustom.field_placeholder }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" ></textarea>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'radio' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == "required" ? myCustom.field_condition : "" }}">';
				                        {% if myCustom.field_options %}
				                            {% for option in myCustom.field_options %}
				                                html += '<div class="radio"><label>';
				                                    html += '<input type="radio" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ option.op_value }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" {{ (option.default_value == "selected") ? 'checked="checked"' : "" }} /> {{ option.op_name }}';
				                                html += '</label> </div>';
				                            {% endfor %}
				                        {% endif %}
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'checkbox' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == "required" ? myCustom.field_condition : "" }}">';
				                        {% if myCustom.field_options %}
				                            {% for option in myCustom.field_options %}
				                                html += '<div class="checkbox"><label>';
				                                    html += '<input type="checkbox" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]" value="{{ option.op_value }}" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" {{ (option.default_value == "selected") ? 'checked="checked"' : "" }} /> {{ option.op_name }}';
				                                html += '</label> </div>';
				                            {% endfor %}
				                        {% endif %}
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'select' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<select name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" >';
				                            {% if myCustom.field_options %}
				                                {% for option in myCustom.field_options %}
				                                    html += '<option value="{{ option.op_value }}" {{ (option.default_value == "selected") ? 'selected="selected"' : "" }} >{{ option.op_name }}</option>';
				                                {% endfor %}
				                            {% endif %}
				                        html += '</select>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				            {% if myCustom.field_input_type == 'multi-select' %}
				                html += '<div class="form-group {{ myCustom.field_condition }}">';
				                    html += '<label class="col-sm-2 control-label" for="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}">{{ myCustom.field_label }}</label>';
				                    html += '<div class="col-sm-10">';
				                        html += '<input type="hidden" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}]" value="{{ myCustom.field_condition == "required" ? myCustom.field_condition : "" }}">';
				                        html += '<select multiple="multiple" name="address[{{ address_row }}][my_custom_fields][{{ myCustom.field_name }}][]" id="input-address{{ address_row }}-custom-field{{ myCustom.db_field_id }}" class="form-control" >';
				                            {% if myCustom.field_options %}
				                                {% for option in myCustom.field_options %}
				                                    html += '<option value="{{ option.op_value }}" {{ (option.default_value == "selected") ? 'selected="selected"' : "" }} >{{ option.op_name }}</option>';
				                                    {% endfor %}
				                                {% endif %}
				                            html += '</select>';
				                    html += '</div>';
				                html += '</div>';
				            {% endif %}

				        {% endfor %}
				    {% endif %}
	            // Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    </file>



<!-- ************************ -->
<!-- CATALOG -->
<!-- ************************ -->


	<!-- ************************ -->
	<!-- CONTROLLER -->
	<!-- ************************ -->

	    <!-- startup - CONTROLLER -->
	    <file path="catalog/controller/startup/startup.php">
	        <operation>
	            <search><![CDATA[$this->tax->setShippingAddress($this->session->data['shipping_address']['country_id'], $this->session->data['shipping_address']['zone_id']);]]></search>
	            <add position="replace"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($this->session->data['shipping_address']['country_id'])) {
						$this->tax->setShippingAddress($this->session->data['shipping_address']['country_id'], $this->session->data['shipping_address']['zone_id']);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->tax->setPaymentAddress($this->session->data['payment_address']['country_id'], $this->session->data['payment_address']['zone_id']);]]></search>
	            <add position="replace"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($this->session->data['payment_address']['country_id'])) {
						$this->tax->setPaymentAddress($this->session->data['payment_address']['country_id'], $this->session->data['payment_address']['zone_id']);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CONFIRM ORDER - CONTROLLER -->
	    <file path="catalog/controller/checkout/confirm.php">

	    	<!-- unset array from session -->
	        <operation>
	            <search><![CDATA[unset($this->session->data['shipping_methods']);]]></search>
	            <add position="after"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($custom_payment_method)) {
						unset($this->session->data['custom_payment_method']);
						unset($this->session->data['custom_shipping_method']);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- unset array from session -->
	        <operation>
	            <search><![CDATA[$this->session->data['order_id'] = $this->model_checkout_order->addOrder($order_data);]]></search>
	            <add position="after"><![CDATA[
					// Extendons - Checkout Manager
						$this->load->model('extension/checkout_manager/checkout');
			        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
							$this->model_extension_checkout_manager_checkout->addOrder($this->session->data);
						}
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- modify existing code -->
	        <operation>
	            <search><![CDATA[$order_data['payment_firstname'] = $this->session->data['payment_address']['firstname'];]]></search>
	            <add position="replace" offset="11"><![CDATA[
				// Extendons - Checkout Manager
					$order_data['payment_firstname'] = (isset($this->session->data['payment_address']['firstname']) ? $this->session->data['payment_address']['firstname'] : '');
					$order_data['payment_lastname'] = (isset($this->session->data['payment_address']['lastname']) ? $this->session->data['payment_address']['lastname'] : '');
					$order_data['payment_company'] = (isset($this->session->data['payment_address']['company']) ? $this->session->data['payment_address']['company'] : '');
					$order_data['payment_address_1'] = (isset($this->session->data['payment_address']['address_1']) ? $this->session->data['payment_address']['address_1'] : '');
					$order_data['payment_address_2'] = (isset($this->session->data['payment_address']['address_2']) ? $this->session->data['payment_address']['address_2'] : '');
					$order_data['payment_city'] = (isset($this->session->data['payment_address']['city']) ? $this->session->data['payment_address']['city'] : '');
					$order_data['payment_postcode'] = (isset($this->session->data['payment_address']['postcode']) ? $this->session->data['payment_address']['postcode'] : '');
					$order_data['payment_zone'] = (isset($this->session->data['payment_address']['zone']) ? $this->session->data['payment_address']['zone'] : '');
					$order_data['payment_zone_id'] = (isset($this->session->data['payment_address']['zone_id']) ? $this->session->data['payment_address']['zone_id'] : '');
					$order_data['payment_country'] = (isset($this->session->data['payment_address']['country']) ? $this->session->data['payment_address']['country'] : '');
					$order_data['payment_country_id'] = (isset($this->session->data['payment_address']['country_id']) ? $this->session->data['payment_address']['country_id'] : '');
					$order_data['payment_address_format'] = (isset($this->session->data['payment_address']['address_format']) ? $this->session->data['payment_address']['address_format'] : '');
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- modify existing code -->
	        <operation>
	            <search><![CDATA[$order_data['shipping_firstname'] = $this->session->data['shipping_address']['firstname'];]]></search>
	            <add position="replace" offset="11"><![CDATA[
				// Extendons - Checkout Manager
					$order_data['shipping_firstname'] = (isset($this->session->data['shipping_address']['firstname']) ? $this->session->data['shipping_address']['firstname'] : '');
					$order_data['shipping_lastname'] = (isset($this->session->data['shipping_address']['lastname']) ? $this->session->data['shipping_address']['lastname'] : '');
					$order_data['shipping_company'] = (isset($this->session->data['shipping_address']['company']) ? $this->session->data['shipping_address']['company'] : '');
					$order_data['shipping_address_1'] = (isset($this->session->data['shipping_address']['address_1']) ? $this->session->data['shipping_address']['address_1'] : '');
					$order_data['shipping_address_2'] = (isset($this->session->data['shipping_address']['address_2']) ? $this->session->data['shipping_address']['address_2'] : '');
					$order_data['shipping_city'] = (isset($this->session->data['shipping_address']['city']) ? $this->session->data['shipping_address']['city'] : '');
					$order_data['shipping_postcode'] = (isset($this->session->data['shipping_address']['postcode']) ? $this->session->data['shipping_address']['postcode'] : '');
					$order_data['shipping_zone'] = (isset($this->session->data['shipping_address']['zone']) ? $this->session->data['shipping_address']['zone'] : '');
					$order_data['shipping_zone_id'] = (isset($this->session->data['shipping_address']['zone_id']) ? $this->session->data['shipping_address']['zone_id'] : '');
					$order_data['shipping_country'] = (isset($this->session->data['shipping_address']['country']) ? $this->session->data['shipping_address']['country'] : '');
					$order_data['shipping_country_id'] = (isset($this->session->data['shipping_address']['country_id']) ? $this->session->data['shipping_address']['country_id'] : '');
					$order_data['shipping_address_format'] = (isset($this->session->data['shipping_address']['address_format']) ? $this->session->data['shipping_address']['address_format'] : '');
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CONFIRM ORDER - CONTROLLER -->
	    <file path="catalog/controller/checkout/guest_shipping.php">

	    	<!-- get custom input fields -->
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/guest_shipping', $data));]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

					$inputFields = '';
					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$inputFields = $this->model_extension_checkout_manager_checkout->getFields();
					}

					if (!empty($inputFields)) {
						foreach ($inputFields as $key => $value) {
							if ($value['field_id'])
							{
								$f_id = explode('input-payment', $value['field_id']);
								// we are changing field id, for the purpose of validation in view, because error text shown on the basis of field id
								$f_id = 'input-shipping'.$f_id[1];

								$inputFields[$key]['field_id'] = $f_id;
							}
						}
						$data['my_custom_input_fields'] = $inputFields;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- update code of errors if any -->
	        <operation>
	            <search index="0"><![CDATA[if (!$json) {]]></search>
	            <add position="after"><![CDATA[
				// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							// echo $q->num_rows;
							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$json['error']['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$json['error']['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'address_1' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
									$json['error']['address_1'] = $this->language->get('error_address_1');
								}
							}

							if ($field_name == 'address_2' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_2'])) < 3) || (utf8_strlen(trim($this->request->post['address_2'])) > 128)) {
									$json['error']['address_2'] = $this->language->get('error_address_2');
								}
							}

							if ($field_name == 'city' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['city']) < 2) || (utf8_strlen($this->request->post['city']) > 32)) {
									$json['error']['city'] = $this->language->get('error_city');
								}
							}

							if ($field_name == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									// if country field is dissabled
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								}
							}

							if ($field_name == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '') {
									$json['error']['country'] = $this->language->get('error_country');
								}
							}

							if ($field_name == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$json['error']['zone'] = $this->language->get('error_zone');
									}
								}
							}
						}

						// if is billing_address
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								if ($q2->num_rows == 1)
								{
									$label = $q2->row['field_label'];
									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										// echo "<pre>";print_r($field_name2[0]);exit();
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[// Custom field validation]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['firstname'] = $this->request->post['firstname'];]]></search>
	            <add position="replace" offset="8"><![CDATA[
				// Extendons - Checkout Manager
					foreach ($this->request->post as $key => $value) {
						if ($key != 'email') {
							if ($key != 'telephone') {
								if ($key != 'billing_address') {
									$this->session->data['shipping_address'][$key] = $value;
								}
							}
						}
					}
					// and billing_address
					if (isset($this->request->post['billing_address'])) {
						foreach ($this->request->post['billing_address'] as $key2 => $value2) {
							$this->session->data['shipping_address']['custom_shipping_address'][$key2] = $value2;
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="2"><![CDATA[$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($this->request->post['country_id']) && !empty($this->request->post['country_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['address_format'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
				// Extendons - Checkout Manager
					} else {
						$this->session->data['shipping_address']['country'] = '';
						$this->session->data['shipping_address']['iso_code_2'] = '';
						$this->session->data['shipping_address']['iso_code_3'] = '';
						$this->session->data['shipping_address']['address_format'] = '';
					}
					if (isset($this->request->post['zone_id']) && !empty($this->request->post['zone_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['zone_code'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
				// Extendons - Checkout Manager
					} else {
						$this->session->data['shipping_address']['zone'] = '';
						$this->session->data['shipping_address']['zone_code'] = '';
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / GUEST - CONTROLLER -->
	    <file path="catalog/controller/checkout/guest.php">
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/guest', $data));]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$data['my_custom_input_fields'] = $this->model_extension_checkout_manager_checkout->getFields();
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {]]></search>
	            <add offset="39" position="replace"><![CDATA[
	            // Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$json['error']['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$json['error']['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'email' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['email']) > 96) || !filter_var($this->request->post['email'], FILTER_VALIDATE_EMAIL)) {
									$json['error']['email'] = $this->language->get('error_email');
								}
							}

							if ($field_name == 'telephone' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['telephone']) < 3) || (utf8_strlen($this->request->post['telephone']) > 32)) {
									$json['error']['telephone'] = $this->language->get('error_telephone');
								}
							}

							if ($field_name == 'address_1' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
									$json['error']['address_1'] = $this->language->get('error_address_1');
								}
							}

							if ($field_name == 'city' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['city'])) < 2) || (utf8_strlen(trim($this->request->post['city'])) > 128)) {
									$json['error']['city'] = $this->language->get('error_city');
								}
							}

							if ($field_name == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									// if country field is dissabled
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								}
							}

							if ($field_name == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '') {
									$json['error']['country'] = $this->language->get('error_country');
								}
							}

							if ($field_name == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$json['error']['zone'] = $this->language->get('error_zone');
									}
								}
							}
						}

						// if is custom address
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name = '" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								if ($q2->num_rows == 1)
								{
									$label = $q2->row['field_label'];
									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
						if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
							$json['error']['firstname'] = $this->language->get('error_firstname');
						}

						if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
							$json['error']['lastname'] = $this->language->get('error_lastname');
						}

						if ((utf8_strlen($this->request->post['email']) > 96) || !filter_var($this->request->post['email'], FILTER_VALIDATE_EMAIL)) {
							$json['error']['email'] = $this->language->get('error_email');
						}

						if ((utf8_strlen($this->request->post['telephone']) < 3) || (utf8_strlen($this->request->post['telephone']) > 32)) {

							$json['error']['telephone'] = $this->language->get('error_telephone');
						}

						if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
							$json['error']['address_1'] = $this->language->get('error_address_1');
						}

						if ((utf8_strlen(trim($this->request->post['city'])) < 2) || (utf8_strlen(trim($this->request->post['city'])) > 128)) {
							$json['error']['city'] = $this->language->get('error_city');
						}

						$this->load->model('localisation/country');

						$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

						if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
							$json['error']['postcode'] = $this->language->get('error_postcode');
						}

						if ($this->request->post['country_id'] == '') {
							$json['error']['country'] = $this->language->get('error_country');
						}

						if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
							$json['error']['zone'] = $this->language->get('error_zone');
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['guest']['firstname'] = $this->request->post['firstname'];]]></search>
	            <add position="replace" offset="1"><![CDATA[
	        	// Extendons - Checkout Manager
					if (isset($this->request->post['firstname'])) {
						$this->session->data['guest']['firstname'] = $this->request->post['firstname'];
					}
					if (isset($this->request->post['lastname'])) {
						$this->session->data['guest']['lastname'] = $this->request->post['lastname'];
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['payment_address']['firstname'] = $this->request->post['firstname'];]]></search>
	            <add position="replace" offset="8"><![CDATA[
	        	// Extendons - Checkout Manager
	        		// this foreach will work remain the same as original line of code, to store form fields data in session
					foreach ($this->request->post as $key => $value) {
						if ($key != 'email') {
							if ($key != 'telephone') {
								if ($key != 'billing_address') {
									$this->session->data['payment_address'][$key] = $value;
								}
							}
						}
					}
					// and if billing_address
					if (isset($this->request->post['billing_address'])) {
						foreach ($this->request->post['billing_address'] as $key2 => $value2) {
							$this->session->data['payment_address']['custom_payment_address'][$key2] = $value2;
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="2"><![CDATA[$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					if (isset($this->request->post['country_id']) && !empty($this->request->post['country_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['payment_address']['address_format'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
	        	// Extendons - Checkout Manager
					} else {
						$this->session->data['payment_address']['country'] = '';
						$this->session->data['payment_address']['iso_code_2'] = '';
						$this->session->data['payment_address']['iso_code_3'] = '';
						$this->session->data['payment_address']['address_format'] = '';
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$zone_info = $this->model_localisation_zone->getZone($this->request->post['zone_id']);]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					if (isset($this->request->post['zone_id']) && !empty($this->request->post['zone_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['payment_address']['zone_code'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
	        	// Extendons - Checkout Manager
					} else {
						$this->session->data['payment_address']['zone'] = '';
						$this->session->data['payment_address']['zone_code'] = '';
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- <operation>
	            <search><![CDATA[if (!empty($this->request->post['shipping_address'])) {]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation> -->

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['firstname'] = $this->request->post['firstname'];]]></search>
	            <add position="replace" offset="8"><![CDATA[
	        	// Extendons - Checkout Manager
	        		// this foreach will work remain the same as original line of code, to store form fields data in session
					foreach ($this->request->post as $key => $value) {
						if ($key != 'email') {
							if ($key != 'telephone') {
								if ($key != 'billing_address') {
									$this->session->data['shipping_address'][$key] = $value;
								}
							}
						}
					}
					// and if billing_address
					if (isset($this->request->post['billing_address'])) {
						foreach ($this->request->post['billing_address'] as $key2 => $value2) {
							$this->session->data['shipping_address']['custom_shipping_address'][$key2] = $value2;
						}
					}
					// for country info
					if (isset($country_info) && !empty($country_info)) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['address_format'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
	        	// Extendons - Checkout Manager
					} else {
						$this->session->data['shipping_address']['country'] = '';
						$this->session->data['shipping_address']['iso_code_2'] = '';
						$this->session->data['shipping_address']['iso_code_3'] = '';
						$this->session->data['shipping_address']['address_format'] = '';
					}
					if (isset($zone_info) && !empty($zone_info)) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address']['zone_code'] = '';]]></search>
	            <add position="after" offset="1"><![CDATA[
	        	// Extendons - Checkout Manager
					} else {
						$this->session->data['shipping_address']['zone'] = '';
						$this->session->data['shipping_address']['zone_code'] = '';
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / GUEST - CONTROLLER -->
	    <file path="catalog/controller/checkout/register.php">
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/register', $data));]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$data['my_custom_input_fields'] = $this->model_extension_checkout_manager_checkout->getFields();
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="0"><![CDATA[$this->load->model('account/customer');]]></search>
	            <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$json['error']['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$json['error']['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'email' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['email']) > 96) || !filter_var($this->request->post['email'], FILTER_VALIDATE_EMAIL)) {
									$json['error']['email'] = $this->language->get('error_email');
								}
							}

							if ($field_name == 'telephone' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['telephone']) < 3) || (utf8_strlen($this->request->post['telephone']) > 32)) {
									$json['error']['telephone'] = $this->language->get('error_telephone');
								}
							}

							if ($field_name == 'address_1' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
									$json['error']['address_1'] = $this->language->get('error_address_1');
								}
							}

							if ($field_name == 'city' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['city'])) < 2) || (utf8_strlen(trim($this->request->post['city'])) > 128)) {
									$json['error']['city'] = $this->language->get('error_city');
								}
							}

							if ($field_name == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									// if country field is dissabled
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								}
							}

							if ($field_name == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '') {
									$json['error']['country'] = $this->language->get('error_country');
								}
							}

							if ($field_name == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$json['error']['zone'] = $this->language->get('error_zone');
									}
								}
							}
						}

						if ((utf8_strlen(html_entity_decode($this->request->post['password'], ENT_QUOTES, 'UTF-8')) < 4) || (utf8_strlen(html_entity_decode($this->request->post['password'], ENT_QUOTES, 'UTF-8')) > 40)) {
							$json['error']['password'] = $this->language->get('error_password');
						}

						if ($this->request->post['confirm'] != $this->request->post['password']) {
							$json['error']['confirm'] = $this->language->get('error_confirm');
						}

						// if is custom address
						$customPaymentAddress = array();
						if (isset($this->request->post['billing_address'])) {
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name = '" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								// store custom created fields data in array, so we are putting it into session below for further use
								if ($f_value2 != 'required') {
									$customPaymentAddress[$field_name2] = $f_value2;
								}

								if ($q2->num_rows == 1)
								{
									$label = $q2->row['field_label'];
									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search index="1"><![CDATA[if ($this->config->get('config_account_id')) {]]></search>
	            <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$address_id = $this->model_account_address->addAddress($customer_id, $this->request->post);]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
					$data = $this->request->post;

					// get last id and assign to address_id
					$data['address_id'] = $address_id;

					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$this->model_extension_checkout_manager_checkout->addCustomAddress($data);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
	        		// remove our custom address data from session
					unset($this->session->data['payment_address']['update_my_custom_address']);

					// store new coming custom fields data in session, to save in custom order table
					$this->session->data['payment_address']['custom_payment_address'] = $customPaymentAddress;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($this->customer->getAddressId());]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
	        		// remove our custom address data from session
					unset($this->session->data['shipping_address']['update_my_custom_address']);

					$this->session->data['shipping_address']['custom_shipping_address'] = $customPaymentAddress;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- PAYMENT ADDRESS - CONTROLLER -->
	    <file path="catalog/controller/checkout/payment_address.php">
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/payment_address', $data));]]></search>
	            <add position="before"><![CDATA[
	            	// Extendons - Checkout Manager
						$this->load->model('extension/checkout_manager/checkout');

						$data['my_custom_input_fields'] = array();
			        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
							$data['my_custom_input_fields'] = $this->model_extension_checkout_manager_checkout->getFields();
						}
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="0"><![CDATA[if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {]]></search>
	            <add position="before"><![CDATA[
	            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							// echo $q->num_rows;
							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$json['error']['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$json['error']['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'address_1' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
									$json['error']['address_1'] = $this->language->get('error_address_1');
								}
							}

							if ($field_name == 'address_2' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_2'])) < 3) || (utf8_strlen(trim($this->request->post['address_2'])) > 128)) {
									$json['error']['address_2'] = $this->language->get('error_address_2');
								}
							}

							if ($field_name == 'city' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['city']) < 2) || (utf8_strlen($this->request->post['city']) > 32)) {
									$json['error']['city'] = $this->language->get('error_city');
								}
							}

							if ($field_name == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									// if country field is dissabled
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								}
							}

							if ($field_name == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '') {
									$json['error']['country'] = $this->language->get('error_country');
								}
							}

							if ($field_name == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$json['error']['zone'] = $this->language->get('error_zone');
									}
								}
							}
						}

						$customPaymentAddress = array();
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								// store custom created fields data in array, so we are putting it into session below for further use
								if ($f_value2 != 'required') {
									$customPaymentAddress[$field_name2] = $f_value2;
								}

								if ($q2->num_rows == 1) {

									$label = $q2->row['field_label'];

									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[// Custom field validation]]></search>
	            <add position="before"><![CDATA[
	            	// Extendons - Checkout Manager
						}
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['payment_address'] = $this->model_account_address->getAddress($address_id);]]></search>
	            <add position="after"><![CDATA[
	            	// Extendons - Checkout Manager
						// fields data
						$data = $this->request->post;

						// get last id and assign to address_id
						$data['address_id'] = $address_id;

						$this->load->model('extension/checkout_manager/checkout');
			        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
							$this->model_extension_checkout_manager_checkout->addCustomAddress($data);
						}

						// remove our custom address data from session
						unset($this->session->data['payment_address']['update_my_custom_address']);

						// store new coming custom fields data in session, to save in custom order table
						$this->session->data['payment_address']['custom_payment_address'] = $customPaymentAddress;
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- PAYMENT METHOD - CONTROLLER -->
	    <file path="catalog/controller/checkout/payment_method.php">
	        <operation>
	            <search><![CDATA[$recurring = $this->cart->hasRecurringProducts();]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['payment_address']['country_id']) || (empty($this->session->data['payment_address']['country_id']) || $this->session->data['payment_address']['country_id'] == 0) ) {
						$this->session->data['payment_address']['country_id'] = 0;
						$this->session->data['payment_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/payment_method', $data));]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$data['text_select'] = $this->language->get('text_select');
					$data['text_none'] = $this->language->get('text_none');

					$this->load->model('extension/checkout_manager/checkout');

					$inputFields = '';
					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$inputFields = $this->model_extension_checkout_manager_checkout->getFields();
					}

					if (!empty($inputFields)) {
						foreach ($inputFields as $key => $value) {
							if ($value['field_id'])
							{
								$f_id = explode('input-payment', $value['field_id']);
								// we are changing field id, for the purpose of validation in view, because error text shown on the basis of field id
								$f_id = 'input-payment-method'.$f_id[1];

								$inputFields[$key]['field_id'] = $f_id;
							}
						}
						$data['my_custom_input_fields'] = $inputFields;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="1"><![CDATA[if ($this->config->get('config_checkout_id')) {]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
	            	else {
						$customPaymentMehodFieldsData = array();
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								// store custom created fields data in array, so we are putting it into session below for further use
								if ($f_value2 != 'required') {
									$customPaymentMehodFieldsData[$field_name2] = $f_value2;
								}

								if ($q2->num_rows == 1)
								{
									$label = $q2->row['field_label'];
									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['comment'] = strip_tags($this->request->post['comment']);]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$this->session->data['custom_payment_method'] = $customPaymentMehodFieldsData;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
                 <operation>
	            <search><![CDATA[if (empty($this->session->data['payment_methods']))]]></search>
	            <add position="before"><![CDATA[
                            $this->load->model('catalog/product');
                            $csa_detail = $this->model_catalog_product->getCustomerCSAVolunteer();
                            $data['checkout_volunteer_messages'] = '';
                            if(!empty($csa_detail)){
                                $data['checkout_volunteer_messages'] = html_entity_decode($csa_detail['checkout_volunteer_messages'], ENT_QUOTES, 'UTF-8');
                            }
		    ]]></add>
	        </operation>
	    </file>

            <file path="catalog/model/catalog/product.php">
                 <operation>
	            <search><![CDATA[public function getProductRelated($product_id)]]></search>
	            <add position="before"><![CDATA[
                        public function getCustomerCSAVolunteer() {
                            $csa_details = array();
                            $query = $this->db->query("SELECT cs.checkout_volunteer_messages,cs.volunteering_required FROM " . DB_PREFIX . "customer c LEFT JOIN " . DB_PREFIX . "csa cs ON(cs.csa_id = c.csa_id) WHERE c.customer_id = '" . (int)$this->customer->getId() . "' AND cs.status = '1'");
                            if ($query->num_rows) {
                                $csa_details = array(
                                    'checkout_volunteer_messages' => $query->row['checkout_volunteer_messages'],
                                    'volunteering_required'       => $query->row['volunteering_required'],
                                );
                            }
                            return $csa_details;
                        }
		    ]]></add>
	        </operation>
	    </file>

	    <!-- SHIPPING ADDRESS - CONTROLLER -->
	    <file path="catalog/controller/checkout/shipping_address.php">
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/shipping_address', $data));]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

					$inputFields = '';
					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$inputFields = $this->model_extension_checkout_manager_checkout->getFields();
					}

					if (!empty($inputFields)) {
						foreach ($inputFields as $key => $value) {
							if ($value['field_id'])
							{
								$f_id = explode('input-payment', $value['field_id']);
								// we are changing field id, for the purpose of validation in view, because error text shown on the basis of field id
								$f_id = 'input-shipping'.$f_id[1];

								$inputFields[$key]['field_id'] = $f_id;
							}
						}
						$data['my_custom_input_fields'] = $inputFields;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="0"><![CDATA[if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							// echo $q->num_rows;
							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$json['error']['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$json['error']['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'address_1' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_1'])) < 3) || (utf8_strlen(trim($this->request->post['address_1'])) > 128)) {
									$json['error']['address_1'] = $this->language->get('error_address_1');
								}
							}

							if ($field_name == 'address_2' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['address_2'])) < 3) || (utf8_strlen(trim($this->request->post['address_2'])) > 128)) {
									$json['error']['address_2'] = $this->language->get('error_address_2');
								}
							}

							if ($field_name == 'city' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['city']) < 2) || (utf8_strlen($this->request->post['city']) > 32)) {
									$json['error']['city'] = $this->language->get('error_city');
								}
							}

							if ($field_name == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									// if country field is dissabled
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$json['error']['postcode'] = $this->language->get('error_postcode');
									}
								}
							}

							if ($field_name == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '') {
									$json['error']['country'] = $this->language->get('error_country');
								}
							}

							if ($field_name == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$json['error']['zone'] = $this->language->get('error_zone');
									}
								}
							}
						}

						$customShippingAddress = array();
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								// store custom created fields data in array, so we are putting it into session below for further use
								if ($f_value2 != 'required') {
									$customShippingAddress[$field_name2] = $f_value2;
								}

								if ($q2->num_rows == 1) {

									$label = $q2->row['field_label'];

									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										// echo "<pre>";print_r($field_name2[0]);exit();
										$json['error'][$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[// Custom field validation]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
            		}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['shipping_address'] = $this->model_account_address->getAddress($address_id);]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					// fields data
					$data = $this->request->post;

					// get last id and assign to address_id
					$data['address_id'] = $address_id;

					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$this->model_extension_checkout_manager_checkout->addCustomAddress($data);
					}

					unset($this->session->data['shipping_address']['update_my_custom_address']);

					$this->session->data['shipping_address']['custom_shipping_address'] = $customShippingAddress;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SHIPPING METHOD - CONTROLLER -->
	    <file path="catalog/controller/checkout/shipping_method.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('shipping');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['shipping_address']['country_id']) || (empty($this->session->data['shipping_address']['country_id']) || $this->session->data['shipping_address']['country_id'] == 0) ) {
						$this->session->data['shipping_address']['country_id'] = 0;
						$this->session->data['shipping_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('checkout/shipping_method', $data));]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					$data['text_select'] = $this->language->get('text_select');
					$data['text_none'] = $this->language->get('text_none');

					$this->load->model('extension/checkout_manager/checkout');

					$inputFields = '';
					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$inputFields = $this->model_extension_checkout_manager_checkout->getFields();
					}

					if (!empty($inputFields)) {
						foreach ($inputFields as $key => $value) {
							if ($value['field_id'])
							{
								$f_id = explode('input-payment', $value['field_id']);
								// we are changing field id, for the purpose of validation in view, because error text shown on the basis of field id
								$f_id = 'input-shipping-method'.$f_id[1];

								$inputFields[$key]['field_id'] = $f_id;
							}
						}
						$data['my_custom_input_fields'] = $inputFields;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$shipping = explode('.', $this->request->post['shipping_method']);]]></search>
	            <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
					$customShippingMehodFieldsData = array();
					if (isset($this->request->post['billing_address']))
					{
						$data = $this->request->post['billing_address'];
						// echo "<pre>";print_r($data);

						foreach ($data as $field_name2 => $f_value2)
						{
							$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							// store custom created fields data in array, so we are putting it into session below for further use
							if ($f_value2 != 'required') {
								$customShippingMehodFieldsData[$field_name2] = $f_value2;
							}

							if ($q2->num_rows == 1) {

								$label = $q2->row['field_label'];

								if ($f_value2 == '' || $f_value2 == 'required') {
									$field_name2 = explode('_custom', $field_name2);
									$json['error'][$field_name2[0]] = $label." field is required!";
								}
							}
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[$this->session->data['comment'] = strip_tags($this->request->post['comment']);]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					$this->session->data['custom_shipping_method'] = $customShippingMehodFieldsData;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ACCOUNT REGISTER - CONTROLLER -->
	    <file path="catalog/controller/account/register.php">
	    	<!-- replace errors code -->
	        <operation>
	            <search><![CDATA[if (isset($this->error['firstname'])) {]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					// extendons - error
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$get_fields = $this->db->query("SELECT field_name FROM " . DB_PREFIX . "extendons_checkout_fields ");

						if ($get_fields->num_rows > 1) {
							foreach ($get_fields->rows as $key => $value)
							{
								$name = $value['field_name'];

								if (isset($this->error[$name])) {
									$data['error']['error_'.$name] = $this->error[$name];
								} else {
									$data['error']['error_'.$name] = '';
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[$data['action'] = $this->url->link('account/register', '', true);]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- get checkout custom fields -->
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('account/register', $data));]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

					$data['my_custom_input_fields'] = array();
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$data['my_custom_input_fields'] = $this->model_extension_checkout_manager_checkout->getFields();

                                                foreach($data['my_custom_input_fields'] as $my_custom_input_fields) {
							if (isset($this->request->post[$my_custom_input_fields['field_name']])) {
								$data['cf'][$my_custom_input_fields['field_name']] = $this->request->post[$my_custom_input_fields['field_name']];
							} else {
								$data['cf'][$my_custom_input_fields['field_name']] = '';
							}

                                                }
                                  }
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- replace validation of fields -->
	        <operation>
	            <search><![CDATA[private function validate() {]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');

		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						foreach ($this->request->post as $field_name => $f_value)
						{
							// query to get required and not required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $field_name . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							if ($field_name == 'firstname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['firstname'])) < 1) || (utf8_strlen(trim($this->request->post['firstname'])) > 32)) {
									$this->error['firstname'] = $this->language->get('error_firstname');
								}
							}

							if ($field_name == 'lastname' && $q->num_rows == 1) {
								if ((utf8_strlen(trim($this->request->post['lastname'])) < 1) || (utf8_strlen(trim($this->request->post['lastname'])) > 32)) {
									$this->error['lastname'] = $this->language->get('error_lastname');
								}
							}

							if ($field_name == 'email' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['email']) > 96) || !filter_var($this->request->post['email'], FILTER_VALIDATE_EMAIL)) {
									$this->error['email'] = $this->language->get('error_email');
								}

								if ($this->model_account_customer->getTotalCustomersByEmail($this->request->post['email'])) {
									$this->error['warning'] = $this->language->get('error_exists');
								}
							}

							if ($field_name == 'telephone' && $q->num_rows == 1) {
								if ((utf8_strlen($this->request->post['telephone']) < 3) || (utf8_strlen($this->request->post['telephone']) > 32)) {
									$this->error['telephone'] = $this->language->get('error_telephone');
								}
							}
						}

						// Customer Group
						if (isset($this->request->post['customer_group_id']) && is_array($this->config->get('config_customer_group_display')) && in_array($this->request->post['customer_group_id'], $this->config->get('config_customer_group_display'))) {
							$customer_group_id = $this->request->post['customer_group_id'];
						} else {
							$customer_group_id = $this->config->get('config_customer_group_id');
						}

						// Custom field validation
						$this->load->model('account/custom_field');

						$custom_fields = $this->model_account_custom_field->getCustomFields($customer_group_id);

						foreach ($custom_fields as $custom_field) {
							if ($custom_field['location'] == 'account') {
								if ($custom_field['required'] && empty($this->request->post['custom_field'][$custom_field['location']][$custom_field['custom_field_id']])) {
									$this->error['custom_field'][$custom_field['custom_field_id']] = sprintf($this->language->get('error_custom_field'), $custom_field['name']);
								} elseif (($custom_field['type'] == 'text') && !empty($custom_field['validation']) && !filter_var($this->request->post['custom_field'][$custom_field['location']][$custom_field['custom_field_id']], FILTER_VALIDATE_REGEXP, array('options' => array('regexp' => $custom_field['validation'])))) {
									$this->error['custom_field'][$custom_field['custom_field_id']] = sprintf($this->language->get('error_custom_field'), $custom_field['name']);
								}
							}
						}

						if ((utf8_strlen(html_entity_decode($this->request->post['password'], ENT_QUOTES, 'UTF-8')) < 4) || (utf8_strlen(html_entity_decode($this->request->post['password'], ENT_QUOTES, 'UTF-8')) > 40)) {
							$this->error['password'] = $this->language->get('error_password');
						}

						if ($this->request->post['confirm'] != $this->request->post['password']) {
							$this->error['confirm'] = $this->language->get('error_confirm');
						}

						// if is my custom address fields
						$customPaymentAddress = array();
						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $field_name2 => $f_value2)
							{
								$q2 = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name = '" . $field_name2 . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

								// store custom created fields data in array, so we are putting it into session below for further use
								if ($f_value2 != 'required') {
									$customPaymentAddress[$field_name2] = $f_value2;
								}

								if ($q2->num_rows == 1)
								{
									$label = $q2->row['field_label'];
									if ($f_value2 == '' || $f_value2 == 'required') {
										$field_name2 = explode('_custom', $field_name2);
										$this->error[$field_name2[0]] = $label." field is required!";
									}
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search index="1"><![CDATA[// Captcha]]></search>
	            <add position="before"><![CDATA[
	        	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ACCOUNT ADDRESS - CONTROLLER -->
	    <file path="catalog/controller/account/address.php">
	    	<!-- modified & replaced - adding address -->
	        <operation>
	            <search><![CDATA[$this->model_account_address->addAddress($this->customer->getId(), $this->request->post);]]></search>
	            <add position="replace"><![CDATA[
            	// Extendons - Checkout Manager
					$address_id = $this->model_account_address->addAddress($this->customer->getId(), $this->request->post);

					if (isset($this->request->post['billing_address'])) {
						$data = $this->request->post;
						$data['address_id'] = $address_id;

						$this->load->model('extension/checkout_manager/checkout');
						$this->model_extension_checkout_manager_checkout->addCustomAddress($data);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- new code added - editing address -->
	        <operation>
	            <search><![CDATA[$this->model_account_address->editAddress($this->request->get['address_id'], $this->request->post);]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					if (isset($this->request->post['billing_address']))
					{
						$this->load->model('extension/checkout_manager/checkout');
						$this->model_extension_checkout_manager_checkout->editCustomAddress($this->request->get['address_id'], $this->request->post);
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- modified & replaced - get address and format it -->
	        <operation>
	            <search index="0"><![CDATA[foreach ($results as $result) {]]></search>
	            <add position="replace" offset="39"><![CDATA[
	        	// Extendons - Checkout Manager
	        		foreach ($results as $result) {
						if (isset($result['my_custom_address']) && !empty($result['my_custom_address']))
						{
							unset($result['my_custom_address']['db_data_id']);
							unset($result['my_custom_address']['zone_code']);
							unset($result['my_custom_address']['iso_code_2']);
							unset($result['my_custom_address']['iso_code_3']);

			    			$find = array();
			    			$replace = array();
			    			$format = '';

			    			// if you have given custom address format or you can use default
			    			if ($result['my_custom_address']['address_format']) {
								$format .= $result['my_custom_address']['address_format'];
							} else {
								$format .= '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
							}

						    foreach ($result['my_custom_address'] as $key1 => $value1) {
						    	// echo"<pre>"; print_r($value1);
					        	if (!is_array($value1)) {
					        		if ($key1 != 'address_format') {
					        			array_push($find, "{" . $key1."}"); // push keys into find array
					        			$replace[$key1] = ucwords($value1); // assign values to each relavent keys
					        		}
					        	} else {
					        		foreach ($value1 as $key2 => $value2)
					        		{
					        			// push custom created keys into find[] array
					        			array_push($find, "{" . $value2['meta_key']."}");

					        			// add custom created keys into format var
						        		$fields = array('firstname', 'lastname', 'company', 'address_1', 'address_2', 'city', 'postcode', 'zone', 'country');
					        			if (!in_array($value2['meta_key'], $fields)) {
					        				$format .= "\n{" . $value2['meta_key'] ."}\n";
					        			}

					        			// if value has serialized data
					        			// $value3 = @unserialize($value2['meta_value']);

					        			if (is_array($value2['meta_value'])) {
					        				// assign values to each relavent keys
					        				$replace[$value2['meta_key']] = ucwords(implode(', ', $value2['meta_value']));
					        			} else {
					        				// assign values to each relavent keys
					        				$replace[$value2['meta_key']] = ucwords($value2['meta_value']);
					        			}
					        		} // end foreach
					        	}
					        }

			    			$data['addresses'][] = array(
								'address_id' => $result['address_id'],
								'address'    => str_replace(array("\r\n", "\r", "\n"), '<br />', preg_replace(array("/\s\s+/", "/\r\r+/", "/\n\n+/"), '<br />', trim(str_replace($find, $replace, $format)))),
								'update'     => $this->url->link('account/address/edit', 'address_id=' . $result['address_id'], true),
								'delete'     => $this->url->link('account/address/delete', 'address_id=' . $result['address_id'], true)
							);

						} else {

							if ($result['address_format']) {
								$format = $result['address_format'];
							} else {
								$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
							}

							$find = array(
								'{firstname}',
								'{lastname}',
								'{company}',
								'{address_1}',
								'{address_2}',
								'{city}',
								'{postcode}',
								'{zone}',
								'{zone_code}',
								'{country}'
							);

							$replace = array(
								'firstname' => $result['firstname'],
								'lastname'  => $result['lastname'],
								'company'   => $result['company'],
								'address_1' => $result['address_1'],
								'address_2' => $result['address_2'],
								'city'      => $result['city'],
								'postcode'  => $result['postcode'],
								'zone'      => $result['zone'],
								'zone_code' => $result['zone_code'],
								'country'   => $result['country']
							);

							$data['addresses'][] = array(
								'address_id' => $result['address_id'],
								'address'    => str_replace(array("\r\n", "\r", "\n"), '<br />', preg_replace(array("/\s\s+/", "/\r\r+/", "/\n\n+/"), '<br />', trim(str_replace($find, $replace, $format)))),
								'update'     => $this->url->link('account/address/edit', 'address_id=' . $result['address_id'], true),
								'delete'     => $this->url->link('account/address/delete', 'address_id=' . $result['address_id'], true)
							);
						} // endif
					} // endforeach
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- modified - assign error lang text to every fields dynamically if any -->
	        <operation>
	            <search><![CDATA[if (isset($this->error['firstname'])) {]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					// extendons - error
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						$get_fields = $this->db->query("SELECT field_name FROM " . DB_PREFIX . "extendons_checkout_fields ");

						if ($get_fields->num_rows > 1) {

							foreach ($get_fields->rows as $key => $value) {

								$name = $value['field_name'];

								if (isset($this->error[$name])) {
									$data['error']['error_'.$name] = $this->error[$name];
								} else {
									$data['error']['error_'.$name] = '';
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[if (isset($this->error['custom_field'])) {]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- new code added - get custom fields if any and add into an array to show in view file -->
	        <operation>
	            <search><![CDATA[$address_info = $this->model_account_address->getAddress($this->request->get['address_id']);]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
		            	if (isset($address_info['update_my_custom_address']) && !empty($address_info['update_my_custom_address']))
						{
							$data['update_my_custom_address'] = $address_info['update_my_custom_address'];

						} else {
							// first signup registered address
							$data['registered_address_before_module'] = $address_info;

							$getAllFieldsID = $this->db->query("SELECT db_field_id FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 ORDER BY field_sort_order");

					        foreach ($getAllFieldsID->rows as $value) {

					            $field_id = $value['db_field_id'];

					            // get single field using has id
					            $getSingleFieldByID = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND db_field_id = " . $field_id);

					            $field_to_show = @unserialize($getSingleFieldByID->row['field_to_show']);
					            $field_visibility = @unserialize($getSingleFieldByID->row['field_visibility']);

					            if ($field_to_show == true) {
					                $getSingleFieldByID->row['field_to_show'] = $field_to_show;
					            }
					            if ($field_visibility == true) {
					                $getSingleFieldByID->row['field_visibility'] = $field_visibility;
					            }

					            // get field option
					            $getSingleFieldByID_options = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields_options WHERE db_field_id = " . $field_id);

					            $getSingleFieldByID->row['field_options'] = array();

					            // if options exists
					            if ($getSingleFieldByID_options->num_rows) {
					                $getSingleFieldByID->row['field_options'] = $getSingleFieldByID_options->rows;
					            }

					            // make it multidimensional
					            $data['update_my_custom_address'][] = $getSingleFieldByID->row;
					        }

						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- modified & replaced - exisiting code commented -->
	        <operation>
	            <search><![CDATA[if (isset($this->request->post['firstname'])) {]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
						// Code removed
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search index="0"><![CDATA[$this->load->model('localisation/country');]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- new code added - get all input fields -->
	        <operation>
	            <search><![CDATA[$this->response->setOutput($this->load->view('account/address_form', $data));]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
	            		if ($this->request->server['REQUEST_METHOD'] == 'POST')
						{
							$getAllFieldsID = $this->db->query("SELECT db_field_id FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 ORDER BY field_sort_order");

							foreach ($getAllFieldsID->rows as $key => $value)
							{
								$field_id = $value['db_field_id'];

								// get single field using its id
								$getSingleFieldByID = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND db_field_id = " . $field_id);

					            $field_to_show = @unserialize($getSingleFieldByID->row['field_to_show']);
					            $field_visibility = @unserialize($getSingleFieldByID->row['field_visibility']);

					            if ($field_to_show == true) {
					                $getSingleFieldByID->row['field_to_show'] = $field_to_show;
					            }
					            if ($field_visibility == true) {
					                $getSingleFieldByID->row['field_visibility'] = $field_visibility;
					            }

					            // get field option
					            $getSingleFieldByID_options = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields_options WHERE db_field_id = " . $field_id);

					            $getSingleFieldByID->row['field_options'] = array();

					            // if options exists
					            if ($getSingleFieldByID_options->num_rows) {
					                $getSingleFieldByID->row['field_options'] = $getSingleFieldByID_options->rows;
					            }

								$data['error_in_input_fields'][] = $getSingleFieldByID->row;
							}

							// entered data with errors
							if (isset($this->request->post)) {
								foreach ($this->request->post as $key => $value) {
									if ($key == 'billing_address') {
										foreach ($this->request->post['billing_address'] as $key => $value) {
											$data['input_keys'][$key] = $value;
										}
									}
									$data['input_keys'][$key] = $value;
								}
							}
						}

						if (!isset($this->request->get['address_id']) && ($this->request->server['REQUEST_METHOD'] != 'POST'))
						{
							$this->load->model('extension/checkout_manager/checkout');

							$data['my_input_fields'] = $this->model_extension_checkout_manager_checkout->getFields();

							if (!isset($data['my_input_fields'])) {
								$data['my_input_fields'] = array();
							}
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- modified & replaced - address validation -->
	        <operation>
	            <search><![CDATA[protected function validateForm() {]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					$this->load->model('extension/checkout_manager/checkout');
		        	if ($this->model_extension_checkout_manager_checkout->isModuleInstalled('checkout_manager')) {
	            		foreach ($this->request->post as $field_name => $value) {
							if (is_array($value))
							{
								$billing_address = $value;

								foreach ($billing_address as $field_name2 => $value2)
								{
									$check_if_exist = $this->db->query("SELECT field_visibility FROM " . DB_PREFIX . "extendons_checkout_fields  WHERE `field_name` = '" . $field_name2 . "' AND `field_visibility` <> '0' ");

									if ($check_if_exist->num_rows) {
										unset($billing_address[$field_name2]);
									}
								}

								$this->request->post[$field_name] = $billing_address;

							} else {

								$check_if_exist = $this->db->query("SELECT field_visibility FROM " . DB_PREFIX . "extendons_checkout_fields  WHERE `field_name` = '" . $field_name . "' AND `field_visibility` <> '0' ");

								if ($check_if_exist->num_rows) {
									unset($this->request->post[$field_name]);
								}
							}
						}

						foreach ($this->request->post as $key => $value)
						{
							// query to get required fields
							$q = $this->db->query("SELECT field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name ='" . $key . "' AND field_condition = 'required' AND field_visibility = '0' LIMIT 1");

							if ($key == 'postcode' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id']))
								{
									$this->load->model('localisation/country');
									$country_info = $this->model_localisation_country->getCountry($this->request->post['country_id']);

									if ($country_info && $country_info['postcode_required'] && (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10)) {
										$this->error['postcode'] = $this->language->get('error_postcode');
									}
								} elseif (!isset($this->request->post['country_id'])) {
									if (utf8_strlen(trim($this->request->post['postcode'])) < 2 || utf8_strlen(trim($this->request->post['postcode'])) > 10) {
										$this->error['postcode'] = $this->language->get('error_postcode');
									}
								}

							} elseif ($key == 'country_id' && $q->num_rows == 1) {
								if ($this->request->post['country_id'] == '' || !is_numeric($this->request->post['country_id'])) {
									$this->error['country'] = $this->language->get('error_country');
								}

							} elseif ($key == 'zone_id' && $q->num_rows == 1) {
								if (isset($this->request->post['country_id'])) {
									if (!isset($this->request->post['zone_id']) || $this->request->post['zone_id'] == '' || !is_numeric($this->request->post['zone_id'])) {
										$this->error['zone'] = $this->language->get('error_zone');
									}
								}

							} else {
								if ($key && $q->num_rows == 1) {
									if ((utf8_strlen(trim($value)) < 1) || (utf8_strlen(trim($value)) > 32)) {
										$this->error[$key] = $this->language->get('error_'.$key);
									}
								}
							}
						}

						if (isset($this->request->post['billing_address']))
						{
							$data = $this->request->post['billing_address'];

							foreach ($data as $key => $value)
							{
								// echo $key;
								$q = $this->db->query("SELECT field_label, field_name, field_condition FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND field_name ='" . $key . "' AND field_visibility = '0' LIMIT 1");

								$condition = $q->row['field_condition'];
								$label = $q->row['field_label'];
								$name = $q->row['field_name'];

								if ($value != 'required') {
									if ($condition == 'required') {
										if ($value == '') {
											$this->error[$name] = $label. ' is required!';
										}

										if (is_array($value) && empty($value)) {
											$this->error[$name] = $label. ' is required!';
										} else {
											if (empty($value)) {
												$this->error[$name] = $label. ' is required!';
											}
										}
									}
								} else {
									$this->error[$name] = $label. ' is required!';
								}
							}
						}
					} else {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[// Custom field validation]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    </file>

	    <!-- ORDER INFO - CONTROLLER -->
	    <file path="catalog/controller/account/order.php">
	        <operation>
	            <search index="0"><![CDATA[if ($order_info) {]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					if (!empty($order_info['additional_custom_fields_info'])) {
						foreach ($order_info['additional_custom_fields_info'] as $key => $more_info)
						{
							$get_label = $this->db->query("SELECT field_label FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $more_info['meta_key'] . "' ");

							if ($get_label->num_rows)
							{
								$title = $get_label->row['field_label'];

								$value = @unserialize($more_info['meta_value']);
								if ($value != true) {
									$value = $more_info['meta_value'];
								}

								if ($more_info['checkout_section'] == 'shipping_address') {
									$shipping_address[$key]['meta_key'] = $title;
									$shipping_address[$key]['meta_value'] = $value;
									$addressMoreInfo['Shipping Address Custom Fields'] = $shipping_address;
								}

								if ($more_info['checkout_section'] == 'payment_address') {
									$payment_address[$key]['meta_key'] = $title;
									$payment_address[$key]['meta_value'] = $value;
									$addressMoreInfo['Payment Address Custom Fields'] = $payment_address;
								}

								if ($more_info['checkout_section'] == 'payment_method') {
									$payment_method[$key]['meta_key'] = $title;
									$payment_method[$key]['meta_value'] = $value;
									$addressMoreInfo['Payment Method Custom Fields'] = $payment_method;
								}

								if ($more_info['checkout_section'] == 'shipping_method') {
									$shipping_method[$key]['meta_key'] = $title;
									$shipping_method[$key]['meta_value'] = $value;
									$addressMoreInfo['Shipping Method Custom Fields'] = $shipping_method;
								}
							}
						} // endforeach

		        		$data['additional_custom_fields_info'] = $addressMoreInfo;
					} // endif
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ORDER INFO - CONTROLLER -->
	    <file path="catalog/controller/mail/order.php">
	        <operation>
	            <search index="0"><![CDATA[$this->load->model('setting/setting');]]></search>
	            <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
					if (!empty($order_info['additional_custom_fields_info'])) {
						foreach ($order_info['additional_custom_fields_info'] as $key => $more_info)
						{
							$get_label = $this->db->query("SELECT field_label FROM " . DB_PREFIX . "extendons_checkout_fields WHERE field_name = '" . $more_info['meta_key'] . "' ");

							if ($get_label->num_rows)
							{
								$title = $get_label->row['field_label'];

								$value = @unserialize($more_info['meta_value']);
								if ($value != true) {
									$value = $more_info['meta_value'];
								}

								if ($more_info['checkout_section'] == 'shipping_address') {
									$shipping_address[$key]['meta_key'] = $title;
									$shipping_address[$key]['meta_value'] = $value;
									$addressMoreInfo['Shipping Address Custom Fields'] = $shipping_address;
								}

								if ($more_info['checkout_section'] == 'payment_address') {
									$payment_address[$key]['meta_key'] = $title;
									$payment_address[$key]['meta_value'] = $value;
									$addressMoreInfo['Payment Address Custom Fields'] = $payment_address;
								}

								if ($more_info['checkout_section'] == 'payment_method') {
									$payment_method[$key]['meta_key'] = $title;
									$payment_method[$key]['meta_value'] = $value;
									$addressMoreInfo['Payment Method Custom Fields'] = $payment_method;
								}

								if ($more_info['checkout_section'] == 'shipping_method') {
									$shipping_method[$key]['meta_key'] = $title;
									$shipping_method[$key]['meta_value'] = $value;
									$addressMoreInfo['Shipping Method Custom Fields'] = $shipping_method;
								}
							}
						} // endforeach

		        		$data['additional_custom_fields_info'] = $addressMoreInfo;
					} // endif
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    </file>

	    <!-- when country is dissabled -->
	    <file path="catalog/controller/extension/module/klarna_checkout_module.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('shipping');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['shipping_address']['country_id']) || (empty($this->session->data['shipping_address']['country_id']) || $this->session->data['shipping_address']['country_id'] == 0) ) {
						$this->session->data['shipping_address']['country_id'] = 0;
						$this->session->data['shipping_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>
	    <file path="catalog/controller/extension/payment/klarna_checkout.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('shipping');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['shipping_address']['country_id']) || (empty($this->session->data['shipping_address']['country_id']) || $this->session->data['shipping_address']['country_id'] == 0) ) {
						$this->session->data['shipping_address']['country_id'] = 0;
						$this->session->data['shipping_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>
	    <file path="catalog/controller/extension/total/shipping.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('shipping');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['shipping_address']['country_id']) || (empty($this->session->data['shipping_address']['country_id']) || $this->session->data['shipping_address']['country_id'] == 0) ) {
						$this->session->data['shipping_address']['country_id'] = 0;
						$this->session->data['shipping_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>
	    <file path="catalog/controller/api/shipping.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('shipping');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['shipping_address']['country_id']) || (empty($this->session->data['shipping_address']['country_id']) || $this->session->data['shipping_address']['country_id'] == 0) ) {
						$this->session->data['shipping_address']['country_id'] = 0;
						$this->session->data['shipping_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>
	    <file path="catalog/controller/api/payment.php">
	        <operation>
	            <search><![CDATA[$results = $this->model_setting_extension->getExtensions('payment');]]></search>
	            <add position="after"><![CDATA[
	        	// Extendons - Checkout Manager
		        	if (!isset($this->session->data['payment_address']['country_id']) || (empty($this->session->data['payment_address']['country_id']) || $this->session->data['payment_address']['country_id'] == 0) ) {
						$this->session->data['payment_address']['country_id'] = 0;
						$this->session->data['payment_address']['zone_id'] = 0;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	<!-- ************************ -->
	<!-- MODEL -->
	<!-- ************************ -->

	    <!-- weight - model -->
	    <!-- <file path="catalog/model/extension/shipping/weight.php">
	        <operation>
	            <search><![CDATA[if ($this->config->get('shipping_weight_' . $result['geo_zone_id'] . '_status')) {]]></search>
	            <add position="after"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($address['country_id']) && !empty($address['country_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[if ($query->num_rows) {]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					} else {
						$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "zone_to_geo_zone WHERE geo_zone_id = '" . (int)$result['geo_zone_id'] . "' AND country_id = '0' AND zone_id = '0'");
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file> -->
	    <!-- free - model -->
	   <!--  <file path="catalog/model/extension/shipping/free.php">
	        <operation>
	            <search><![CDATA[$this->load->language('extension/shipping/free');]]></search>
	            <add position="after"><![CDATA[
				// Extendons - Checkout Manager
					if (isset($address['country_id']) && !empty($address['country_id'])) {
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[if (!$this->config->get('shipping_free_geo_zone_id')) {]]></search>
	            <add position="before"><![CDATA[
				// Extendons - Checkout Manager
					} else {
						$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "zone_to_geo_zone WHERE geo_zone_id = '" . (int)$this->config->get('shipping_free_geo_zone_id') . "' AND country_id = '0' AND zone_id = '0'");
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file> -->


	    <!-- ACCOUNT ADDRESS - MODEL -->
	    <file path="catalog/model/account/address.php">
	    	<!-- modified & replaced - add address query modified -->
	        <operation>
	            <search><![CDATA[public function addAddress($customer_id, $data) {]]></search>
	            <add offset="10" position="replace"><![CDATA[
	            // Query modified by Extendons - Checkout Manager
	            	public function addAddress($customer_id, $data) {

						$this->db->query("INSERT INTO " . DB_PREFIX . "address SET
							customer_id = '" . (int)$customer_id . "', firstname = '" . (isset($data['firstname']) ? $this->db->escape($data['firstname']) : '') . "', lastname = '" . (isset($data['lastname']) ? $this->db->escape($data['lastname']) : '') . "', company = '" . (isset($data['company']) ? $this->db->escape($data['company']) : '') . "', address_1 = '" . (isset($data['address_1']) ? $this->db->escape($data['address_1']) : '') . "', address_2 = '" . (isset($data['address_2']) ? $this->db->escape($data['address_2']) : '') . "', postcode = '" . (isset($data['postcode']) ? $this->db->escape($data['postcode']) : '') . "', city = '" . (isset($data['city']) ? $this->db->escape($data['city']) : '') . "', zone_id = '" . (isset($data['zone_id']) ? (int)$data['zone_id'] : '') . "', country_id = '" . (isset($data['country_id']) ? (int)$data['country_id'] : '') . "', custom_field = '" . $this->db->escape(isset($data['custom_field']) ? json_encode($data['custom_field']) : '') . "'");

						$address_id = $this->db->getLastId();

						if (!empty($data['default'])) {
							$this->db->query("UPDATE " . DB_PREFIX . "customer SET address_id = '" . (int)$address_id . "' WHERE customer_id = '" . (int)$customer_id . "'");
						}

						return $address_id;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- modified & replaced - edit address query modified -->
	        <operation>
	            <search><![CDATA[public function editAddress($address_id, $data) {]]></search>
	            <add offset="6" position="replace"><![CDATA[
            	// Update Query modified by Extendons - Checkout Manager
	            	public function editAddress($address_id, $data) {
						$sql = "UPDATE " . DB_PREFIX . "address SET ";

						foreach ($data as $field_name => $value) {
							if ($field_name != 'default') {
								if ($field_name != 'billing_address') {
									if (isset($value) && !empty($value)) {
										$sql .= "`" . $field_name . "` = '" . $this->db->escape($value) . "', ";
									}
								}
							}
						}

						$sql .= "custom_field = '" . $this->db->escape(isset($data['custom_field']) ? json_encode($data['custom_field']) : '') . "' WHERE address_id  = '" . (int)$address_id . "' AND customer_id = '" . (int)$this->customer->getId() . "'";

						$this->db->query($sql);

						if (!empty($data['default'])) {
							$this->db->query("UPDATE " . DB_PREFIX . "customer SET address_id = '" . (int)$address_id . "' WHERE customer_id = '" . (int)$this->customer->getId() . "'");
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- modified & replaced - edit address query modified -->
	        <operation>
	            <search><![CDATA[public function deleteAddress($address_id) {]]></search>
	            <add offset="1" position="after"><![CDATA[
            	// Extendons - Checkout Manager
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
		            	$custom_data_q = $this->db->query("SELECT db_data_id FROM " . DB_PREFIX . "extendons_checkout_fields_data WHERE address_id  = '" . (int)$address_id . "' AND customer_id = '" . (int)$this->customer->getId() . "'");

						$db_data_id = $custom_data_q->row['db_data_id'];

						$this->db->query("DELETE FROM " . DB_PREFIX . "extendons_checkout_fields_data_columns  WHERE `customer_id` = '" . (int)$this->customer->getId() . "' AND `db_data_id` = '" . $db_data_id . "' ");

						$this->db->query("DELETE FROM " . DB_PREFIX . "extendons_checkout_fields_data  WHERE address_id  = '" . (int)$address_id . "' AND customer_id = '" . (int)$this->customer->getId() . "' ");
			        }
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- new code added - to get my custom fields data -->
	        <operation>
	            <search index="0"><![CDATA[$address_data = array(]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
	            		$getIDofCustomAddress = $this->db->query("SELECT db_data_id FROM " . DB_PREFIX . "extendons_checkout_fields_data WHERE address_id = '" . $address_id . "' AND customer_id = '" . (int)$this->customer->getId() . "'");

						if ($getIDofCustomAddress->num_rows)
						{
							// my custom address id
							$my_custom_address_id = $getIDofCustomAddress->row['db_data_id'];

							// get all input fields with status = 1
							$getAllFieldsID = $this->db->query("SELECT db_field_id FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 ORDER BY field_sort_order");

							// loop through all input fields
							foreach ($getAllFieldsID->rows as $value)
							{
								$db_field_id = $value['db_field_id'];

								// get single input field using its id
								$getSingleFieldByID = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields WHERE status = 1 AND db_field_id = " . $db_field_id);

								$field_to_show = @unserialize($getSingleFieldByID->row['field_to_show']);
								$field_visibility = @unserialize($getSingleFieldByID->row['field_visibility']);

								if ($field_to_show == true) {
									$getSingleFieldByID->row['field_to_show'] = $field_to_show;
								}
								if ($field_visibility == true) {
									$getSingleFieldByID->row['field_visibility'] = $field_visibility;
								}

								// if field has options
								$getSingleFieldByID_options = $this->db->query("SELECT * FROM " . DB_PREFIX . "extendons_checkout_fields_options WHERE db_field_id = " . $db_field_id);

								$getSingleFieldByID->row['field_options'] = array();

								// if field_options exists
								if ($getSingleFieldByID_options->num_rows) {
									$getSingleFieldByID->row['field_options'] = $getSingleFieldByID_options->rows;
								}

								// get data of all input fields from both table using left join where id=field_id and data_id=the id which is coming from data table ($my_custom_address_id)
								$custom_address_query2 = $this->db->query("SELECT * FROM
														" . DB_PREFIX . "extendons_checkout_fields_data ecfd
														WHERE ecfd.db_data_id = " . $my_custom_address_id);

								$custom_address_meta_q = $this->db->query("SELECT * FROM
														" . DB_PREFIX . "extendons_checkout_fields_data_columns ecfdc
														WHERE ecfdc.db_field_id = " . $db_field_id." AND ecfdc.db_data_id = " . $my_custom_address_id." AND ecfdc.customer_id = ". (int)$this->customer->getId());

								// this meta value is from column table
								$meta_value = @unserialize($custom_address_meta_q->row['meta_value']);
								if ($meta_value == true) {
									$custom_address_meta_q->row['meta_value'] = $meta_value;
								}


								$custom_address_query2->row['meta_address'] = $custom_address_meta_q->row;
								$getSingleFieldByID->row['my_custom_address'] = $custom_address_query2->row;

								$update_my_custom_address[] = $getSingleFieldByID->row;
							} // endforeach
						}
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA['custom_field'   => json_decode($address_query->row['custom_field'], true)]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					,'update_my_custom_address' => (isset($update_my_custom_address) && !empty($update_my_custom_address)) ? $update_my_custom_address : array()
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	    	<!-- same below - new code added - to get my custom fields data -->
	        <operation>
	            <search><![CDATA[$address_data[$result['address_id']] = array(]]></search>
	            <add position="before"><![CDATA[
	            // Extendons - Checkout Manager
	        		$my_custom_address = array();
	        		$custom_fields_values = array();
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
						// get new added fields and existing fields data from my custom table
						$col_data = $this->db->query("SELECT address_id, db_data_id, firstname, lastname, company, address_1, address_2, postcode, city  FROM " . DB_PREFIX . "extendons_checkout_fields_data WHERE address_id = '" . $result['address_id'] . "' AND customer_id = '" . (int)$this->customer->getId() . "'");

						$my_custom_address = $col_data->row;

						if ($col_data->num_rows) {
							$my_custom_address['zone'] 				= $zone;
							$my_custom_address['zone_code'] 		= $zone_code;
							$my_custom_address['country'] 			= $country;
							$my_custom_address['iso_code_2'] 		= $iso_code_2;
							$my_custom_address['iso_code_3'] 		= $iso_code_3;
							$my_custom_address['address_format'] 	= $address_format;

							$db_data_id = $col_data->row['db_data_id'];

							$col_q = $this->db->query("SELECT meta_key, meta_value FROM " . DB_PREFIX . "extendons_checkout_fields_data_columns WHERE `db_data_id` = '" . $db_data_id . "' ");
							if ($col_q->num_rows) {
								foreach ($col_q->rows as $k => $val)
								{
									$check = @unserialize($val['meta_value']);
									if ($check == true) {
										$val['meta_value'] = $check;
									}
									$custom_fields_values[$k]['meta_key'] = $val['meta_key'];
									$custom_fields_values[$k]['meta_value'] = $val['meta_value'];
								}
							}
							$my_custom_address['custom_fields_values'] = $custom_fields_values;
						}
					}
					// echo "<pre>";print_r($custom_fields_values);
					// echo "<pre>";print_r($my_custom_address);exit;
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA['custom_field'   => json_decode($result['custom_field'], true)]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					,'my_custom_address'   => $my_custom_address
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / ORDER - MODEL -->
	    <file path="catalog/model/checkout/order.php">
			<operation>
			    <search><![CDATA[$this->db->query("DELETE FROM `" . DB_PREFIX . "customer_transaction` WHERE order_id = '" . (int)$order_id . "'");]]></search>
			    <add position="after"><![CDATA[
	            // Extendons - Checkout Manager
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

				    if ($check->num_rows) {
	            		$this->db->query("DELETE FROM `" . DB_PREFIX . "extendons_checkout_fields_order` WHERE order_id = '" . (int)$order_id . "'");
	            	}
				// Extendons - Checkout Manager /- End
				]]></add>
			</operation>

	        <operation>
	            <search><![CDATA[return array(]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
            		$additional_custom_fields_info = array();
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
						$additional_custom_fields_info = $this->db->query("SELECT meta_key, meta_value, checkout_section FROM `" . DB_PREFIX . "extendons_checkout_fields_order` WHERE  order_id = '" . (int)$order_id . "' AND customer_id = '" . (int)$this->customer->getId() . "'");

						$additional_custom_fields_info = $additional_custom_fields_info->rows;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA['date_modified'           => $order_query->row['date_modified']]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					,'additional_custom_fields_info'		  => $additional_custom_fields_info
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ORDER INFO - MODEL -->
	    <file path="catalog/model/account/order.php">
	        <operation>
	            <search><![CDATA[return array(]]></search>
	            <add position="before"><![CDATA[
            	// Extendons - Checkout Manager
            		$additional_custom_fields_info = array();
	            	$check = $this->db->query("SELECT * FROM `" . DB_PREFIX . "extension` WHERE `code` = 'checkout_manager'");

			        if ($check->num_rows) {
						$additional_custom_fields_info = $this->db->query("SELECT meta_key, meta_value, checkout_section FROM `" . DB_PREFIX . "extendons_checkout_fields_order` WHERE  order_id = '" . (int)$order_id . "' AND customer_id = '" . (int)$this->customer->getId() . "'");
						$additional_custom_fields_info = $additional_custom_fields_info->rows;
					}
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA['ip'                      => $order_query->row['ip']]]></search>
	            <add position="after"><![CDATA[
            	// Extendons - Checkout Manager
					,'additional_custom_fields_info'		  => $additional_custom_fields_info
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>


	<!-- ************************ -->
	<!-- VIEW -->
	<!-- ************************ -->

	    <!-- CHECKOUT / GUEST_SHIPPING - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/guest_shipping.twig">
	        <operation>
	            <search><![CDATA[<form class="form-horizontal">]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
				        {% for field in my_custom_input_fields %}
				            {% if field.field_input_type == 'text' and (7 in field.field_to_show) %}

				                {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}
			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
				                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <input
	                                            	type="text"
				                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
				                                    value=""
				                                    placeholder="{{ field.field_placeholder }}"
				                                    id="{{ field.field_id }}"
				                                    class="form-control"
				                                />
				                            </div>
				                        </div>
				                    {% endif %}
				                {% endif %} {% endif %}

				            {% elseif field.field_input_type == 'date' and (7 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <div class="input-group date" >
				                                    <input
	                                            		type="text"
				                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
				                                        value=""
				                                        placeholder="YYYY-MM-DD"
				                                        id="{{ field.field_id }}"
				                                        class="form-control"
				                                        data-date-format="YYYY-MM-DD"
				                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
				                                </div>
				                            </div>
				                    </div>
				                {% endif %}

				            {% elseif field.field_input_type == 'time' and (7 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <div class="input-group time">
				                                    <input
	                                            		type="text"
				                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
				                                        value=""
				                                        placeholder="HH:mm"
				                                        id="{{ field.field_id }}"
				                                        class="form-control"
				                                        data-date-format="HH:mm"
				                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
				                                </div>
				                            </div>
				                    </div>
				                {% endif %}

				            {% elseif field.field_input_type == 'datetime' and (7 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <div class="input-group datetime">

				                                    <input
	                                            		type="text"
				                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
				                                        value=""
				                                        placeholder="YYYY-MM-DD HH:mm"
				                                        id="{{ field.field_id }}" class="form-control"
				                                        data-date-format="YYYY-MM-DD HH:mm"
				                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
				                                </div>
				                            </div>
				                    </div>
				                {% endif %}

				            {% elseif field.field_input_type == 'textarea' and (7 in field.field_to_show) %}

				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <textarea cols="3"
				                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
				                                    id="{{ field.field_id }}"
				                                    class="form-control"
				                                    placeholder="{{ field.field_placeholder }}"
				                                ></textarea>
				                            </div>
				                    </div>

				            {% elseif field.field_input_type == 'radio' and (7 in field.field_to_show) %}

				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
				                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
				                                {% endif %}

				                                {% if field.field_options is not empty %}
				                                    {% for option in field.field_options %}

				                                            <label class="radio-inline">
				                                                <input type="radio"
				                                                    name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
				                                                    value="{{ option.op_value }}"
				                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
				                                                />
				                                                {{ option.op_name }}
				                                            </label>

				                                    {% endfor %}
				                                {% endif %}
				                            </div>
				                            <!-- show error here by finding this id -->
				                            <input type="hidden" id="{{ field.field_id }}">
				                    </div>

				            {% elseif field.field_input_type == 'checkbox' and (7 in field.field_to_show) %}

				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
				                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
				                                {% endif %}

				                                {% if field.field_options is not empty %}
				                                    {% for option in field.field_options %}

				                                            <label class="checkbox-inline">
				                                                <input type="checkbox"
				                                                    name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
				                                                    value="{{ option.op_value }}"
				                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
				                                                />
				                                                {{ option.op_name }}
				                                            </label>

				                                    {% endfor %}
				                                {% endif %}
				                            </div>
				                            <!-- show error here by finding this id -->
				                            <input type="hidden" id="{{ field.field_id }}">
				                    </div>

				            {% elseif field.field_input_type == 'select' and (7 in field.field_to_show) %}

				                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                        <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <select
				                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
				                                    id="{{ field.field_id }}"
				                                    class="form-control"
				                                >
				                                    {% if (field.field_name == 'country_id') %}
				                                            <option value="">{{ text_select }}</option>
				                                            {% for country in countries %}
				                                                    {% if country.country_id == country_id %}
				                                                        <option value="{{ country.country_id }}" selected="selected">{{ country.name }}</option>
				                                                    {% else %}
				                                                        <option value="{{ country.country_id }}">{{ country.name }}</option>
				                                                    {% endif %}
				                                            {% endfor %}
				                                    {% else %}

				                                            {% if field.field_options is not empty %}
				                                                {% for option in field.field_options %}

				                                                        <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }} >{{ option.op_name }}</option>

				                                                {% endfor %}
				                                            {% endif %}

				                                    {% endif %}
				                                </select>
				                            </div>
				                    </div>

				            {% elseif field.field_input_type == 'multi-select' and (7 in field.field_to_show) %}

				                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                        <label class="col-md-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                        <div class="col-sm-10">
				                            {% if (field.field_condition is defined and field.field_condition == 'required') %}
				                                <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
				                            {% endif %}

				                            <div class="input-group" style="border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
				                                {% if field.field_options is not empty %}
				                                    {% for option in field.field_options %}
				                                        <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
				                                            <input type="checkbox" aria-label="..."
				                                            name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
				                                            value="{{ option.op_value }}"
				                                            {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
				                                            >
				                                            {{ option.op_name }}
				                                        </label><br>
				                                    {% endfor %}
				                                {% endif %}
				                                <input type="hidden" id="{{ field.field_id }}">
				                            </div>
				                        </div>
				                </div>

				            {% endif %}
				        {% endfor %}

				    {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / GUEST - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/guest.twig">
	        <operation>
	            <search><![CDATA[<label class="control-label" for="input-payment-firstname">{{ entry_firstname }}</label>]]></search>
	            <add position="before" offset="1"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'text' and (6 in field.field_to_show) %}
			                    {% if field.field_name == 'firstname' or field.field_name == 'lastname' or field.field_name == 'email' or field.field_name == 'telephone' %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
			                            <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                    <input
	                                            	type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />

			                            </div>
			                    	{% endif %}
			                    {% endif %}
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<legend>{{ text_your_address }}</legend>]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}

			                {% if field.field_input_type == 'text' and (6 in field.field_to_show) %}

			                        {% if field.field_name != 'firstname' %} {% if field.field_name != 'lastname' %} {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %} {% if field.field_name != 'password' %} {% if field.field_name != 'confirm' %}

				                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
				                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
				                        {% else %}
				                            <div class="form-group {{ field.field_condition }}">
				                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

				                                    <input
		                                            	type="text"
				                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
				                                        value=""
				                                        placeholder="{{ field.field_placeholder }}"
				                                        id="{{ field.field_id }}"
				                                        class="form-control"
				                                    />
				                            </div>
			                        	{% endif %}
			                        {% endif %} {% endif %} {% endif %} {% endif %} {% endif %} {% endif %}

			                {% elseif field.field_input_type == 'date' and (6 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                <div class="input-group date" >
			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'time' and (6 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                <div class="input-group time">
			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="HH:mm"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'datetime' and (6 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                <div class="input-group datetime">

			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD HH:mm"
			                                        id="{{ field.field_id }}" class="form-control"
			                                        data-date-format="YYYY-MM-DD HH:mm"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>

			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'textarea' and (6 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                <textarea cols="3"
			                                    name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                    id="{{ field.field_id }}"
			                                    class="form-control"
			                                    placeholder="{{ field.field_placeholder }}"
			                                ></textarea>
			                        </div>

			                {% elseif field.field_input_type == 'radio' and (6 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                                {% endif %}

			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}

			                                            <label class="radio-inline">
			                                                <input type="radio"
			                                                    name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                                    value="{{ option.op_value }}"
			                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
			                                                />
			                                                {{ option.op_name }}
			                                            </label>

			                                    {% endfor %}
			                                {% endif %}
			                                <!-- show error here by finding this id -->
			                                <input type="hidden" id="{{ field.field_id }}">
			                        </div>

			                {% elseif field.field_input_type == 'checkbox' and (6 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                                {% endif %}

			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}

			                                            <label class="checkbox-inline">
			                                                <input type="checkbox"
			                                                    name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
			                                                    value="{{ option.op_value }}"
			                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
			                                                />
			                                                {{ option.op_name }}
			                                            </label>

			                                    {% endfor %}
			                                {% endif %}
			                                <!-- show error here by finding this id -->
			                                <input type="hidden" id="{{ field.field_id }}">
			                        </div>

			                {% elseif field.field_input_type == 'select' and (6 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                            <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                <select
			                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                    id="{{ field.field_id }}"
			                                    class="form-control"
			                                >
			                                    {% if (field.field_name == 'country_id') %}
			                                            <option value="">{{ text_select }}</option>
			                                            {% for country in countries %}
			                                                    {% if country.country_id == country_id %}
			                                                        <option value="{{ country.country_id }}" selected="selected">{{ country.name }}</option>
			                                                    {% else %}
			                                                        <option value="{{ country.country_id }}">{{ country.name }}</option>
			                                                    {% endif %}
			                                            {% endfor %}
			                                    {% else %}

			                                            {% if field.field_options is not empty %}
			                                                {% for option in field.field_options %}

			                                                        <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }} >{{ option.op_name }}</option>

			                                                {% endfor %}
			                                            {% endif %}

			                                    {% endif %}
			                                </select>
			                        </div>

			                {% elseif field.field_input_type == 'multi-select' and (6 in field.field_to_show) %}

			                    <div class="form-group {{ field.field_condition }}">
			                            <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                            {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                            {% endif %}

			                            <div class="input-group" style="border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}
			                                        <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
			                                            <input type="checkbox" aria-label="..."
			                                            name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
			                                            value="{{ option.op_value }}"
			                                            {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
			                                            >
			                                            {{ option.op_name }}
			                                        </label><br>
			                                    {% endfor %}
			                                {% endif %}
			                                <input type="hidden" id="{{ field.field_id }}">
			                            </div>
			                    </div>

			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <!-- place {% endif %} before both for loop -->
	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / REGISTER - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/register.twig">
	        <operation>
	            <search index="0"><![CDATA[<div class="form-group required">]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'text' and (5 in field.field_to_show) %}
			                    {% if field.field_name == 'firstname' or field.field_name == 'lastname' or field.field_name == 'email' or field.field_name == 'telephone' %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
			                            <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                    <input
	                                            	type="text"
			                                        name="{{ field.field_name }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />

			                            </div>
			                    	{% endif %}
			                    {% endif %}
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<legend>{{ text_your_address }}</legend>]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'text' and (5 in field.field_to_show) %}
			                        {% if field.field_name != 'firstname' %} {% if field.field_name != 'lastname' %} {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %} {% if field.field_name != 'password' %} {% if field.field_name != 'confirm' %}

				                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
				                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
				                        {% else %}
				                            <div class="form-group {{ field.field_condition }}">
				                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                                    <input
		                                            	type="text"
				                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
				                                        value=""
				                                        placeholder="{{ field.field_placeholder }}"
				                                        id="{{ field.field_id }}"
				                                        class="form-control"
				                                    />
				                            </div>
			                            {% endif %}
			                        {% endif %} {% endif %} {% endif %} {% endif %} {% endif %} {% endif %}

			                {% elseif field.field_input_type == 'date' and (5 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="input-group date" >
			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'time' and (5 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="input-group time">
			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="HH:mm"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'datetime' and (5 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="input-group datetime">
			                                    <input
	                                            	type="text"
			                                        name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD HH:mm"
			                                        id="{{ field.field_id }}" class="form-control"
			                                        data-date-format="YYYY-MM-DD HH:mm"
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                        </div>
			                    {% endif %}

			                {% elseif field.field_input_type == 'textarea' and (5 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <textarea cols="3"
			                                    name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                    id="{{ field.field_id }}"
			                                    class="form-control"
			                                    placeholder="{{ field.field_placeholder }}"
			                                ></textarea>
			                        </div>

			                {% elseif field.field_input_type == 'radio' and (5 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                                {% endif %}
			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}
			                                            <label class="radio-inline">
			                                                <input type="radio"
			                                                    name="{{ 'billing_address[' ~ field.field_name ~ ']' }}"
			                                                    value="{{ option.op_value }}"
			                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
			                                                />
			                                                {{ option.op_name }}
			                                            </label>
			                                    {% endfor %}
			                                {% endif %}
			                                <!-- show error here by finding this id -->
			                                <input type="hidden" id="{{ field.field_id }}">
			                        </div>

			                {% elseif field.field_input_type == 'checkbox' and (5 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                    <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                                {% endif %}
			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}
			                                            <label class="checkbox-inline">
			                                                <input type="checkbox"
			                                                    name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
			                                                    value="{{ option.op_value }}"
			                                                    {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
			                                                />
			                                                {{ option.op_name }}
			                                            </label>
			                                    {% endfor %}
			                                {% endif %}
			                                <!-- show error here by finding this id -->
			                                <input type="hidden" id="{{ field.field_id }}">
			                        </div>

			                {% elseif field.field_input_type == 'select' and (5 in field.field_to_show) %}

			                        <div class="form-group {{ field.field_condition }}">
			                            <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <select
			                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                    id="{{ field.field_id }}"
			                                    class="form-control"
			                                >
			                                    {% if (field.field_name == 'country_id') %}
			                                            <option value="">{{ text_select }}</option>
			                                            {% for country in countries %}
			                                                    {% if country.country_id == country_id %}
			                                                        <option value="{{ country.country_id }}" selected="selected">{{ country.name }}</option>
			                                                    {% else %}
			                                                        <option value="{{ country.country_id }}">{{ country.name }}</option>
			                                                    {% endif %}
			                                            {% endfor %}
			                                    {% else %}
			                                            {% if field.field_options is not empty %}
			                                                {% for option in field.field_options %}
			                                                        <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }} >{{ option.op_name }}</option>
			                                                {% endfor %}
			                                            {% endif %}
			                                    {% endif %}
			                                </select>
			                        </div>

			                {% elseif field.field_input_type == 'multi-select' and (5 in field.field_to_show) %}

			                    <div class="form-group {{ field.field_condition }}">
			                            <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            {% if (field.field_condition is defined and field.field_condition == 'required') %}
			                                <input type="hidden" name="{{ 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
			                            {% endif %}
			                            <div class="input-group" style="border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
			                                {% if field.field_options is not empty %}
			                                    {% for option in field.field_options %}
			                                        <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
			                                            <input type="checkbox" aria-label="..."
			                                            name="{{ 'billing_address[' ~ field.field_name ~ '][]' }}"
			                                            value="{{ option.op_value }}"
			                                            {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
			                                            >
			                                            {{ option.op_name }}
			                                        </label><br>
			                                    {% endfor %}
			                                {% endif %}
			                                <input type="hidden" id="{{ field.field_id }}">
			                            </div>
			                    </div>
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <!-- place {% endif %} before both for loop -->
	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<legend>{{ text_your_password }}</legend>]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'password' and (5 in field.field_to_show) %}
			                    {% if field.field_name == 'password' or field.field_name == 'confirm' %}

			                            <div class="form-group {{ field.field_condition }}">
			                                <label class="control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>

			                                    <input
			                                        type="password"
			                                        name="{{ field.field_name }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />
			                            </div>
			                    {% endif %}
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="1"><![CDATA[</fieldset>]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- CHECKOUT / CHECKOUT - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/checkout.twig">
	        <!-- payment address section -->
	        <operation>
	            <search><![CDATA[var element = $('#input-payment-' + i.replace('_', '-'));]]></search>
	            <add position="replace"><![CDATA[
	        	// Modified By Extendons - Checkout Manager
					// var element = $('#input-payment-' + i.replace('_', '-'));
					// We are replacing the above line, to replace multiple underscore into hyphen
					var element = $('#input-payment-' + i.replace(/_/g, '-'));
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- shipping address section - hidden type added -->
	        <operation>
	            <search><![CDATA[data: $('#collapse-shipping-address input[type=\'text\'], #collapse-shipping-address input[type=\'date\'], #collapse-shipping-address input[type=\'datetime-local\'], #collapse-shipping-address input[type=\'time\'], #collapse-shipping-address input[type=\'password\'], #collapse-shipping-address input[type=\'checkbox\']:checked, #collapse-shipping-address input[type=\'radio\']:checked, #collapse-shipping-address textarea, #collapse-shipping-address select'),]]></search>
	            <add position="replace"><![CDATA[
	            // Modified By Extendons - Checkout Manager
					data: $('#collapse-shipping-address input[type=\'hidden\'], #collapse-shipping-address input[type=\'text\'], #collapse-shipping-address input[type=\'date\'], #collapse-shipping-address input[type=\'datetime-local\'], #collapse-shipping-address input[type=\'time\'], #collapse-shipping-address input[type=\'password\'], #collapse-shipping-address input[type=\'checkbox\']:checked, #collapse-shipping-address input[type=\'radio\']:checked, #collapse-shipping-address textarea, #collapse-shipping-address select'),
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- shipping address section -->
	        <operation>
	            <search><![CDATA[var element = $('#input-shipping-' + i.replace('_', '-'));]]></search>
	            <add position="replace"><![CDATA[
	        	// Modified By Extendons - Checkout Manager
					// var element = $('#input-shipping-' + i.replace('_', '-'));
					// We are replacing the above line, to replace multiple underscore into hyphen
					var element = $('#input-shipping-' + i.replace(/_/g, '-'));
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- shipping method section - all type added -->
	        <operation>
	            <search><![CDATA[data: $('#collapse-shipping-method input[type=\'radio\']:checked, #collapse-shipping-method textarea'),]]></search>
	            <add position="replace"><![CDATA[
	            // Modified By Extendons - Checkout Manager
					data: $('#collapse-shipping-method input[type=\'hidden\'], #collapse-shipping-method input[type=\'text\'], #collapse-shipping-method input[type=\'date\'], #collapse-shipping-method input[type=\'datetime-local\'], #collapse-shipping-method input[type=\'time\'], #collapse-shipping-method input[type=\'password\'], #collapse-shipping-method input[type=\'checkbox\']:checked, #collapse-shipping-method input[type=\'radio\']:checked, #collapse-shipping-method textarea, #collapse-shipping-method select'),
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- shipping method section - show error if any -->
	        <operation>
	            <search index="0"><![CDATA[$('#button-shipping-method').button('reset');]]></search>
	            <add position="after" offset="4"><![CDATA[
	            // Modified By Extendons - Checkout Manager
	                for (i in json['error']) {
	                    var element = $('#input-shipping-method-' + i.replace(/_/g, '-'));

	                    if ($(element).parent().hasClass('input-group')) {
	                        $(element).parent().after('<div class="text-danger">' + json['error'][i] + '</div>');
	                    } else {
	                        $(element).after('<div class="text-danger">' + json['error'][i] + '</div>');
	                    }
	                }
	                // Highlight any found errors
	                $('.text-danger').parent().addClass('has-error');
				// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- payment method section - all type added -->
	        <operation>
	            <search><![CDATA[data: $('#collapse-payment-method input[type=\'radio\']:checked, #collapse-payment-method input[type=\'checkbox\']:checked, #collapse-payment-method textarea'),]]></search>
	            <add position="replace"><![CDATA[
	            	// Modified By Extendons - Checkout Manager
					data: $('#collapse-payment-method input[type=\'hidden\'], #collapse-payment-method input[type=\'text\'], #collapse-payment-method input[type=\'date\'], #collapse-payment-method input[type=\'datetime-local\'], #collapse-payment-method input[type=\'time\'], #collapse-payment-method input[type=\'password\'], #collapse-payment-method input[type=\'checkbox\']:checked, #collapse-payment-method input[type=\'radio\']:checked, #collapse-payment-method textarea, #collapse-payment-method select'),
					// Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>

	        <!-- payment method section - show error if any -->
	        <operation>
	            <search index="0"><![CDATA[$('#button-payment-method').button('reset');]]></search>
	            <add position="after" offset="4"><![CDATA[
	            // Modified By Extendons - Checkout Manager
	                for (i in json['error']) {
	                    var element = $('#input-payment-method-' + i.replace(/_/g, '-'));
	                    if ($(element).parent().hasClass('input-group')) {
	                        $(element).parent().after('<div class="text-danger">' + json['error'][i] + '</div>');
	                    } else {
	                        $(element).after('<div class="text-danger">' + json['error'][i] + '</div>');
	                    }
	                }
	                // Highlight any found errors
	                $('.text-danger').parent().addClass('has-error');
	            // Extendons - Checkout Manager /- End
		    	]]></add>
	        </operation>
	    </file>

	    <!-- PAYMENT ADDRESS - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/payment_address.twig">
	    	<!-- modified & replaced - showing address in select option tab -->
	    	<operation>
	            <search><![CDATA[{% for address in addresses %}]]></search>
	            <add offset="6" position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                {% for address in addresses %}
	                    {% if (address['address_id'] == address_id) %}
	                        <option value="{{ address['address_id'] }}" selected="selected">
	                            {{ (address['firstname'] is not empty) ? address['firstname'] ~ ', ' : '' }}
	                            {{ (address['lastname'] is not empty) ? address['lastname'] ~ ', ' : '' }}
	                            {{ (address['address_1'] is not empty) ? address['address_1'] ~ ', ' : '' }}
	                            {{ (address['city'] is not empty) ? address['city'] ~ ', ' : '' }}
	                            {{ (address['zone'] is not empty) ? address['zone'] ~ ', ' : '' }}
	                            {{ (address['country'] is not empty) ? address['country'] ~ ', ' : '' }}
	                            {% if (address['my_custom_address'] is defined and address['my_custom_address']) %}
	                                {% if address['my_custom_address'].custom_fields_values is defined %}
	                                    {% for value in address['my_custom_address']['custom_fields_values'] %}
	                                        {% if (value['meta_value'] is not empty and value['meta_value'] is iterable) %}
	                                            {% for val in value['meta_value'] %}
	                                                {{ val|capitalize }},
	                                            {% endfor %}
	                                        {% else %}
	                                            {{ (value['meta_value'] is not empty) ? value['meta_value']|capitalize ~ ', ' : '' }}
	                                        {% endif %}
	                                    {% endfor %}
	                                {% endif %}
	                            {% endif %}
	                        </option>
	                    {% else %}
	                        <option value="{{ address['address_id'] }}">
	                            {{ (address['firstname'] is not empty) ? address['firstname'] ~ ', ' : '' }}
	                            {{ (address['lastname'] is not empty) ? address['lastname'] ~ ', ' : '' }}
	                            {{ (address['address_1'] is not empty) ? address['address_1'] ~ ', ' : '' }}
	                            {{ (address['city'] is not empty) ? address['city'] ~ ', ' : '' }}
	                            {{ (address['zone'] is not empty) ? address['zone'] ~ ', ' : '' }}
	                            {{ (address['country'] is not empty) ? address['country'] ~ ', ' : '' }}
	                            {% if (address['my_custom_address'] is defined and address['my_custom_address']) %}
	                                {% if address['my_custom_address'].custom_fields_values is defined %}
	                                    {% for value in address['my_custom_address']['custom_fields_values'] %}
	                                        {% if (value['meta_value'] is not empty and value['meta_value'] is iterable) %}
	                                            {% for val in value['meta_value'] %}
	                                                {{ val|capitalize }},
	                                            {% endfor %}
	                                        {% else %}
	                                            {{ (value['meta_value'] is not empty) ? value['meta_value']|capitalize ~ ', ' : '' }}
	                                        {% endif %}
	                                    {% endfor %}
	                                {% endif %}
	                            {% endif %}
	                        </option>
	                    {% endif %}
	                {% endfor %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	    	<!-- modified & replaced - existing address form -->
	        <operation>
	            <search><![CDATA[<div id="payment-new" style="display: {% if addresses %}none{% else %}block{% endif %};">]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                {% if my_custom_input_fields is defined and my_custom_input_fields is not empty %}
	                    {% for field in my_custom_input_fields %}
	                        {% if field.field_input_type == 'text' and (1 in field.field_to_show) %}
				                {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}
			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
			                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="col-sm-10">
			                                    <input
			                                        type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />
			                                </div>
			                            </div>
		                            {% endif %}
	                            {% endif %} {% endif %}

	                        {% elseif field.field_input_type == 'date' and (1 in field.field_to_show) %}
		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group date">
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="YYYY-MM-DD"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            data-date-format="YYYY-MM-DD"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                            {% endif %}

	                        {% elseif field.field_input_type == 'time' and (1 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group time">
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="HH:mm"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            data-date-format="HH:mm"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                            {% endif %}

	                        {% elseif field.field_input_type == 'datetime' and (1 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group datetime">
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="YYYY-MM-DD HH:mm"
		                                            id="{{ field.field_id }}" class="form-control"
		                                            data-date-format="YYYY-MM-DD HH:mm"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                            {% endif %}

	                        {% elseif field.field_input_type == 'textarea' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <textarea cols="3"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                        placeholder="{{ field.field_placeholder }}"
	                                    ></textarea>
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'radio' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
	                                    {% endif %}
	                                    {% if field.field_options is not empty %}
	                                        {% for option in field.field_options %}
	                                                <label class="radio-inline">
	                                                    <input type="radio"
	                                                        name="billing_address[{{ field.field_name }}]"
	                                                        value="{{ option.op_value }}"
	                                                        {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
	                                                    />
	                                                    {{ option.op_name }}
	                                                </label>
	                                        {% endfor %}
	                                    {% endif %}
	                                    <!-- show error here by finding this id -->
	                                    <input type="hidden" id="{{ field.field_id }}">
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'checkbox' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">

	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
	                                    {% endif %}
	                                    {% if field.field_options is not empty %}
	                                        {% for option in field.field_options %}
	                                                <label class="checkbox-inline">
	                                                    <input type="checkbox"
	                                                        name="billing_address[{{ field.field_name }}][]"
	                                                        value="{{ option.op_value }}"
	                                                        {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
	                                                    />
	                                                    {{ option.op_name }}
	                                                </label>
	                                        {% endfor %}
	                                    {% endif %}
	                                    <!-- show error here by finding this id -->
	                                    <input type="hidden" id="{{ field.field_id }}">
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'select' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <select
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                        {{ (field.field_condition == 'required') ? 'required' : '' }}
	                                    >
	                                        {% if (field.field_name == 'country_id') %}
	                                            <option value="">{{ text_select }}</option>
	                                            {% for country in countries %}
	                                                {% if country.country_id == country_id %}
	                                                <option value="{{ country.country_id }}" selected="selected">{{ country.name }}</option>
	                                                {% else %}
	                                                <option value="{{ country.country_id }}">{{ country.name }}</option>
	                                                {% endif %}
	                                            {% endfor %}
	                                        {% else %}
	                                                {% if field.field_options is not empty %}
	                                                    {% for option in field.field_options %}
	                                                            <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }} >{{ option.op_name }}</option>
	                                                    {% endfor %}
	                                                {% endif %}
	                                        {% endif %}
	                                    </select>
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'multi-select' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
	                                    {% endif %}
	                                    <div class="input-group" style="width:{{ (field.field_width is not empty) ? field.field_width ~ '%' : '100%' }};border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
	                                        {% if field.field_options is not empty %}
	                                            {% for option in field.field_options %}
	                                                <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
	                                                    <input type="checkbox" aria-label="..."
	                                                    name="billing_address[{{ field.field_name }}][]"
	                                                    value="{{ option.op_value }}"
	                                                    {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
	                                                    >
	                                                    {{ option.op_name }}
	                                                </label><br>
	                                            {% endfor %}
	                                        {% endif %}
	                                        <input type="hidden" id="{{ field.field_id }}">
	                                    </div>

	                                    <!-- <select
	                                        multiple="multiple"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]"
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if field.field_options is not empty %}
	                                            {% for option in field.field_options %}
	                                                    <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }}>{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select> -->
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'file' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="file"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        value=""
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                        accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf"
	                                    />
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'image' and (1 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="file"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        value=""
	                                        id="{{ field.field_id }}" class="form-control"
	                                        accept="image/*"
	                                    />
	                                </div>
	                            </div>
	                        {% endif %}
	                    {% endfor %}
	                {% else %}
	            <!-- Extendons - Checkout Manager -->
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- PAYMENT METHOD - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/payment_method.twig">

	    	<!-- modified & replaced - existing address form -->
	        <operation>
	            <search><![CDATA[<p><strong>{{ text_comments }}</strong></p>]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	            	<br>
		    		{% if (my_custom_input_fields is defined and my_custom_input_fields is not empty) %}
						{% for field in my_custom_input_fields %}
						  	{% if ( field['field_input_type'] == 'text' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p><input type="text"
								                name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                value=""
								                placeholder="{{ field['field_placeholder'] }}"
								                id="{{ field['field_id'] }}"
								                class="form-control"/>
								  		</p>
								  	</div>
	                          	{% endif %}

						  {% elseif ( field['field_input_type'] == 'date' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p><div class="input-group date">
								                  <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="YYYY-MM-DD"
								                      id="{{ field['field_id'] }}"
								                      class="form-control"
								                      data-date-format="YYYY-MM-DD"
								                  /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								        </div></p>
							        </div>
	                          	{% endif %}

						  {% elseif (field['field_input_type'] == 'time' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p><div class="input-group time" >
								                <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="HH:mm"
								                      id="{{ field['field_id'] }}"
								                      class="form-control"
								                      data-date-format="HH:mm"
								                /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								        </div></p>
							        </div>
	                          	{% endif %}

						  {% elseif (field['field_input_type'] == 'datetime' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							    	<div class="col-sm-12" style="width:{{ field.field_width }}%">
								      	<p><strong>{{ field['field_label'] }}</strong></p>
								  		<p><div class="input-group datetime" >
								                  <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="YYYY-MM-DD HH:mm"
								                      id="{{ field['field_id'] }}" class="form-control"
								                      data-date-format="YYYY-MM-DD HH:mm"
								                  /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								        </div></p>
							        </div>
	                          	{% endif %}

						  {% elseif (field['field_input_type'] == 'textarea' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p><textarea cols="3"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  id="{{ field['field_id'] }}"
							                  class="form-control"
							                  placeholder="{{ field['field_placeholder'] }}">
							        </textarea></p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'radio' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
				                    <p>
							  			{% if (field['field_condition'] is defined and field['field_condition'] == 'required') %}
							                <input type="hidden" name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}" value="{{ field['field_condition'] }}">
							            {% endif %}
				                        {% if (field['field_options'] is not empty) %}
					                        {% for option in field['field_options'] %}
					                        		<label class="radio-inline">
						                                <input type="radio"
						                                    name="billing_address[{{ field['field_name'] }}]"
						                                    value="{{ option['op_value'] }}"
						                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
						                                />
						                                {{ option['op_name'] }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}
				                        <!-- show error here by finding this id -->
				                        <input type="hidden" id="{{ field['field_id'] }}">
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'checkbox' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="padding-left: 0px;padding-bottom: 10px;width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
                                                                        <div class="checkout_volunteer_messages">{{checkout_volunteer_messages}}</div>
							  			{% if (field['field_condition'] is defined and field['field_condition'] == 'required') %}
							                  <input type="hidden" name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}" value="{{ field['field_condition'] }}">
							              {% endif %}
				                        {% if (field['field_options'] is not empty) %}
					                        {% for option in field['field_options'] %}
					                        		<label class="checkbox-inline">
						                                <input type="checkbox"
						                                    name="billing_address[{{ field['field_name'] }}][]"
						                                    value="{{ option['op_value'] }}"
						                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
						                                />
						                                {{ option['op_name'] }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}
				                        <!-- show error here by finding this id -->
				                        <input type="hidden" id="{{ field['field_id'] }}">
				                    </p>
				                </div>

						  {% elseif (field['field_input_type'] == 'select' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						        <div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
							  			<select
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  id="{{ field['field_id'] }}"
							                  class="form-control" >
					                        {% if (field['field_options'] is not empty) %}
						                        {% for option in field['field_options'] %}
							                            <option value="{{ option['op_value'] }}" {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}>{{ option['op_name'] }}</option>
						                        {% endfor %}
					                        {% endif %}
							              </select>
							  		</p>
							  	</div>

						  {% elseif ( field['field_input_type'] == 'multi-select' and (field['field_existance'] != 'default') and (field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						        <div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
		                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
		                                        <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                    {% endif %}
		                                    <div class="input-group" style="width:{{ (field.field_width is not empty) ? field.field_width ~ '%' : '100%' }};border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
		                                        {% if field.field_options is not empty %}
		                                            {% for option in field.field_options %}
		                                                <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
		                                                    <input type="checkbox" aria-label="..."
		                                                    name="billing_address[{{ field.field_name }}][]"
		                                                    value="{{ option.op_value }}"
		                                                    {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
		                                                    >
		                                                    {{ option.op_name }}
		                                                </label><br>
		                                            {% endfor %}
		                                        {% endif %}
		                                        <input type="hidden" id="{{ field.field_id }}">
		                                    </div>

							  			<!-- <select
							                  multiple="multiple"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}[]"
							                  id="{{ field['field_id'] }}"
							                  class="form-control"
							              >
						                        {% if (field['field_options'] is not empty) %}
							                        {% for option in field['field_options'] %}
								                            <option value="{{ option['op_value'] }}" {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}>{{ option['op_name'] }}</option>
							                        {% endfor %}
						                        {% endif %}
							              </select> -->
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'file' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p><input type="file"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  value=""
							                  id="{{ field['field_id'] }}"
							                  class="form-control"
							                  accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf" />
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'image' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 4 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p><input type="file"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  value=""
							                  id="{{ field['field_id'] }}" class="form-control"
							                  accept="image/*" />
							  		</p>
							  	</div>
						  	{% endif %}
						{% endfor %}
					{% endif %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<input type="button" value="{{ button_continue }}" id="button-payment-method" data-loading-text="{{ text_loading }}" class="btn btn-primary" />]]></search>
	            <add position="after" offset="2"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
					<script type="text/javascript"><!--
						$('.date').datetimepicker({
							pickTime: false
						});

						$('.time').datetimepicker({
							pickDate: false
						});

						$('.datetime').datetimepicker({
							pickDate: true,
							pickTime: true
						});
					//--></script>

					<script type="text/javascript"><!--
						$('#collapse-payment-method select[name=\'country_id\']').on('change', function() {
							$.ajax({
								url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
								dataType: 'json',
								beforeSend: function() {
									$('#collapse-payment-method select[name=\'country_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');
								},
								complete: function() {
									$('.fa-spin').remove();
								},
								success: function(json) {
									if (json['postcode_required'] == '1') {
										$('#collapse-payment-method input[name=\'postcode\']').parent().parent().addClass('required');
									} else {
										$('#collapse-payment-method input[name=\'postcode\']').parent().parent().removeClass('required');
									}

									html = '<option value="">{{ text_select }}</option>';

									if (json['zone'] && json['zone'] != '') {
										for (i = 0; i < json['zone'].length; i++) {
											html += '<option value="' + json['zone'][i]['zone_id'] + '"';

											if (json['zone'][i]['zone_id'] == '{{ zone_id }}') {
												html += ' selected="selected"';
											}

											html += '>' + json['zone'][i]['name'] + '</option>';
										}
									} else {
										html += '<option value="0" selected="selected">{{ text_none }}</option>';
									}

									$('#collapse-payment-method select[name=\'zone_id\']').html(html);
								},
								error: function(xhr, ajaxOptions, thrownError) {
									alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
								}
							});
						});

						$('#collapse-payment-method select[name=\'country_id\']').trigger('change');
					//--></script>
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SHIPPING ADDRESS - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/shipping_address.twig">

	    	<!-- modified & replaced - showing address in select option tab -->
	    	<operation>
	            <search><![CDATA[{% for address in addresses %}]]></search>
	            <add offset="6" position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
			        {% for address in addresses %}
			            {% if (address['address_id'] == address_id) %}
			                <option value="{{ address['address_id'] }}" selected="selected">
			                    {{ (address['firstname']) ? address['firstname'] ~ ', ' : '' }}
			                    {{ (address['lastname']) ? address['lastname'] ~ ', ' : '' }}
			                    {{ (address['address_1']) ? address['address_1'] ~ ', ' : '' }}
			                    {{ (address['city']) ? address['city'] ~ ', ' : '' }}
			                    {{ (address['zone']) ? address['zone'] ~ ', ' : '' }}
			                    {{ (address['country']) ? address['country'] ~ ', ' : '' }}
			                    {% if (address['my_custom_address'] is defined and address['my_custom_address']) %}
	                                {% if address['my_custom_address'].custom_fields_values is defined %}
	                                    {% for value in address['my_custom_address']['custom_fields_values'] %}
	                                        {% if (value['meta_value'] is not empty and value['meta_value'] is iterable) %}
	                                            {% for val in value['meta_value'] %}
	                                                {{ val|capitalize }},
	                                            {% endfor %}
	                                        {% else %}
	                                            {{ (value['meta_value'] is not empty) ? value['meta_value']|capitalize ~ ', ' : '' }}
	                                        {% endif %}
	                                    {% endfor %}
	                                {% endif %}
	                            {% endif %}
			                </option>
			            {% else %}
			                <option value="{{ address['address_id'] }}">
			                    {{ (address['firstname']) ? address['firstname'] ~ ', ' : '' }}
			                    {{ (address['lastname']) ? address['lastname'] ~ ', ' : '' }}
			                    {{ (address['address_1']) ? address['address_1'] ~ ', ' : '' }}
			                    {{ (address['city']) ? address['city'] ~ ', ' : '' }}
			                    {{ (address['zone']) ? address['zone'] ~ ', ' : '' }}
			                    {{ (address['country']) ? address['country'] ~ ', ' : '' }}
			                    <!-- {{ address['firstname'] }} {{ address['lastname'] }}, {{ address['address_1'] }}, {{ address['city'] }}, {{ address['zone'] }}, {{ address['country'] }} -->
	                            {% if (address['my_custom_address'] is defined and address['my_custom_address']) %}
	                                {% if address['my_custom_address'].custom_fields_values is defined %}
	                                    {% for value in address['my_custom_address']['custom_fields_values'] %}
	                                        {% if (value['meta_value'] is not empty and value['meta_value'] is iterable) %}
	                                            {% for val in value['meta_value'] %}
	                                                {{ val|capitalize }},
	                                            {% endfor %}
	                                        {% else %}
	                                            {{ (value['meta_value'] is not empty) ? value['meta_value']|capitalize ~ ', ' : '' }}
	                                        {% endif %}
	                                    {% endfor %}
	                                {% endif %}
	                            {% endif %}
			                </option>
	                    {% endif %}
	                {% endfor %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<div id="shipping-new" style="display: {% if addresses %}none{% else %}block{% endif %};">]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
		    		{% if my_custom_input_fields is defined and my_custom_input_fields is not empty %}
	                    {% for field in my_custom_input_fields %}
	                        {% if field.field_input_type == 'text' and (2 in field.field_to_show) %}

				                {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
			                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="col-sm-10">
			                                    <input
			                                        type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control" />
			                                </div>
			                            </div>
		                    		{% endif %}
	                    		{% endif %} {% endif %}

	                        {% elseif field.field_input_type == 'date' and (2 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group date" {{ (field.field_width is not empty) ? 'style="width:' ~ field.field_width ~ '%;"' : '' }} >
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="YYYY-MM-DD"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            data-date-format="YYYY-MM-DD"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                    		{% endif %}

	                        {% elseif field.field_input_type == 'time' and (2 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group time" {{ (field.field_width is not empty) ? 'style="width:' ~ field.field_width ~ '%;"' : '' }} >
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="HH:mm"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            data-date-format="HH:mm"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                    		{% endif %}

	                        {% elseif field.field_input_type == 'datetime' and (2 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <div class="input-group datetime" {{ (field.field_width is not empty) ? 'style="width:' ~ field.field_width ~ '%;"' : '' }} >
		                                        <input
		                                            type="text"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            value=""
		                                            placeholder="YYYY-MM-DD HH:mm"
		                                            id="{{ field.field_id }}" class="form-control"
		                                            data-date-format="YYYY-MM-DD HH:mm"
		                                        /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                    </div>
		                                </div>
		                            </div>
	                    		{% endif %}

	                        {% elseif field.field_input_type == 'textarea' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <textarea cols="3"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                        placeholder="{{ field.field_placeholder }}"
	                                    ></textarea>
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'radio' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
	                                    {% endif %}
	                                    {% if field.field_options is not empty %}
	                                        {% for option in field.field_options %}
	                                                <label class="radio-inline">
	                                                    <input type="radio"
	                                                        name="billing_address[{{ field.field_name }}]"
	                                                        value="{{ option.op_value }}"
	                                                        {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
	                                                    />
	                                                    {{ option.op_name }}
	                                                </label>
	                                        {% endfor %}
	                                    {% endif %}
	                                    <!-- show error here by finding this id -->
	                                    <input type="hidden" id="{{ field.field_id }}">
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'checkbox' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ field.field_condition }}">
	                                    {% endif %}

	                                    {% if field.field_options is not empty %}
	                                        {% for option in field.field_options %}
	                                                <label class="checkbox-inline">
	                                                    <input type="checkbox"
	                                                        name="billing_address[{{ field.field_name }}][]"
	                                                        value="{{ option.op_value }}"
	                                                        {{ (option.default_value == 'selected') ? 'checked="checked"' : '' }}
	                                                    />
	                                                    {{ option.op_name }}
	                                                </label>
	                                        {% endfor %}
	                                    {% endif %}
	                                    <!-- show error here by finding this id -->
	                                    <input type="hidden" id="{{ field.field_id }}">
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'select' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <select
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        id="{{ field.field_id }}"
	                                        class="form-control" >
	                                        {% if (field.field_name == 'country_id') %}
	                                            <option value="">{{ text_select }}</option>
	                                            {% for country in countries %}
	                                                {% if country.country_id == country_id %}
	                                                <option value="{{ country.country_id }}" selected="selected">{{ country.name }}</option>
	                                                {% else %}
	                                                <option value="{{ country.country_id }}">{{ country.name }}</option>
	                                                {% endif %}
	                                            {% endfor %}
	                                        {% else %}
	                                                {% if field.field_options is not empty %}
	                                                    {% for option in field.field_options %}
	                                                            <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }} >{{ option.op_name }}</option>
	                                                    {% endfor %}
	                                                {% endif %}
	                                        {% endif %}
	                                    </select>
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'multi-select' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
	                                        <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
	                                    {% endif %}
	                                    <div class="input-group" style="width:{{ (field.field_width is not empty) ? field.field_width ~ '%' : '100%' }};border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
	                                        {% if field.field_options is not empty %}
	                                            {% for option in field.field_options %}
	                                                <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
	                                                    <input type="checkbox" aria-label="..."
	                                                    name="billing_address[{{ field.field_name }}][]"
	                                                    value="{{ option.op_value }}"
	                                                    {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
	                                                    >
	                                                    {{ option.op_name }}
	                                                </label><br>
	                                            {% endfor %}
	                                        {% endif %}
	                                        <input type="hidden" id="{{ field.field_id }}">
	                                    </div>

	                                    <!-- <select
	                                        multiple="multiple"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]"
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                    >
	                                        {% if field.field_options is not empty %}
	                                            {% for option in field.field_options %}
	                                                    <option value="{{ option.op_value }}" {{ (option.default_value == 'selected') ? 'selected="selected"' : '' }}>{{ option.op_name }}</option>
	                                            {% endfor %}
	                                        {% endif %}
	                                    </select> -->
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'file' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="file"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        value=""
	                                        id="{{ field.field_id }}"
	                                        class="form-control"
	                                        accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf"
	                                    />
	                                </div>
	                            </div>

	                        {% elseif field.field_input_type == 'image' and (2 in field.field_to_show) %}

	                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
	                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
	                                <div class="col-sm-10">
	                                    <input type="file"
	                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
	                                        value=""
	                                        id="{{ field.field_id }}" class="form-control"
	                                        accept="image/*" />
	                                </div>
	                            </div>
	                        {% endif %}
	                    {% endfor %}
	                {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- SHIPPING METHOD - VIEW -->
	    <file path="catalog/view/theme/*/template/checkout/shipping_method.twig">

	    	<!-- modified & replaced - existing address form -->
	        <operation>
	            <search><![CDATA[<p><strong>{{ text_comments }}</strong></p>]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	            	<br>
		    		{% if (my_custom_input_fields is defined and my_custom_input_fields is not empty) %}
						{% for field in my_custom_input_fields %}

						  	{% if ( field['field_input_type'] == 'text' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p>
								  			<input
		                                        type="text"
								                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                  value=""
								                  placeholder="{{ field['field_placeholder'] }}"
								                  id="{{ field['field_id'] }}"
								                  class="form-control"
						                          {{ (field['field_condition'] == 'required') ? 'required' : '' }}
								            />
								  		</p>
								  	</div>
			                    {% endif %}

						  {% elseif ( field['field_input_type'] == 'date' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p>
								  			<div class="input-group date" {{ (field['field_width'] is not empty) ? 'style="width:' ~ field['field_width'] ~ '%;"' : '' }} >
								                  <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="YYYY-MM-DD"
								                      id="{{ field['field_id'] }}"
								                      class="form-control"
								                      data-date-format="YYYY-MM-DD"
						                            {{ (field['field_condition'] == 'required') ? 'required' : '' }}
								                  /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								              </div>
								  		</p>
								    </div>
			                    {% endif %}

						  {% elseif (field['field_input_type'] == 'time' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
								  		<p>
								  			<div class="input-group time" {{ (field['field_width'] is not empty) ? 'style="width:' ~ field['field_width'] ~ '%;"' : '' }} >
								                  <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="HH:mm"
								                      id="{{ field['field_id'] }}"
								                      class="form-control"
								                      data-date-format="HH:mm"
								                  /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								              </div>
								  		</p>
								    </div>
			                    {% endif %}

						  {% elseif (field['field_input_type'] == 'datetime' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
							  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
								      	<p><strong>{{ field['field_label'] }}</strong></p>
								  		<p>
								  			<div class="input-group datetime" {{ (field['field_width'] is not empty) ? 'style="width:' ~ field['field_width'] ~ '%;"' : '' }} >
								                  <input
		                                            type="text"
								                      name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
								                      value=""
								                      placeholder="YYYY-MM-DD HH:mm"
								                      id="{{ field['field_id'] }}" class="form-control"
								                      data-date-format="YYYY-MM-DD HH:mm"
								                  /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
								              </div>
								  		</p>
								   	</div>
			                    {% endif %}

						  {% elseif (field['field_input_type'] == 'textarea' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
							  			<textarea cols="3"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  id="{{ field['field_id'] }}"
							                  class="form-control"
							                  placeholder="{{ field['field_placeholder'] }}"
							              ></textarea>
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'radio' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
				                    <p>
							  			{% if (field['field_condition'] is defined and field['field_condition'] == 'required') %}
							                <input type="hidden" name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}" value="{{ field['field_condition'] }}">
							            {% endif %}

				                        {% if (field['field_options'] is not empty) %}
					                        {% for option in field['field_options'] %}
					                        		<label class="radio-inline">
						                                <input type="radio"
						                                    name="billing_address[{{ field['field_name'] }}]"
						                                    value="{{ option['op_value'] }}"
						                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
						                                />
						                                {{ option['op_name'] }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}
				                        <!-- show error here by finding this id -->
				                        <input type="hidden" id="{{ field['field_id'] }}">
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'checkbox' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
							  			{% if (field['field_condition'] is defined and field['field_condition'] == 'required') %}
							                  <input type="hidden" name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}" value="{{ field['field_condition'] }}">
							              {% endif %}

				                        {% if (field['field_options'] is not empty) %}
					                        {% for option in field['field_options'] %}
					                        		<label class="checkbox-inline">
						                                <input type="checkbox"
						                                    name="billing_address[{{ field['field_name'] }}][]"
						                                    value="{{ option['op_value'] }}"
						                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
						                                />
						                                {{ option['op_name'] }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}
				                        <!-- show error here by finding this id -->
				                        <input type="hidden" id="{{ field['field_id'] }}">
				                    </p>
				                </div>

						  {% elseif (field['field_input_type'] == 'select' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						        <div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
							  			<select
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  id="{{ field['field_id'] }}"
							                  class="form-control" >
							                  {% if (field['field_name'] == 'country_id') %}
							                      <option value="">{{ text_select }}</option>
							                      {% for country in countries %}
							                          {% if (country['country_id'] == country_id) %}
							                              <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
							                          {% else %}
							                              <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
							                          {% endif %}
							                      {% endfor %}
							                  {% else %}
								                        {% if (field['field_options'] is not empty) %}
									                        {% for option in field['field_options'] %}
										                            <option value="{{ option['op_value'] }}" {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}>{{ option['op_name'] }}</option>
									                        {% endfor %}
								                        {% endif %}
							                  {% endif %}
							              </select>
							  		</p>
							  	</div>

						  {% elseif ( field['field_input_type'] == 'multi-select' and (field['field_existance'] != 'default') and (field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						        <div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p>
		                                    {% if (field.field_condition is defined and field.field_condition == 'required') %}
		                                        <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                    {% endif %}
		                                    <div class="input-group" style="width:{{ (field.field_width is not empty) ? field.field_width ~ '%' : '100%' }};border: 1px solid #ccc;border-radius: 4px;padding: 5px 15px 5px 15px;">
		                                        {% if field.field_options is not empty %}
		                                            {% for option in field.field_options %}
		                                                <label style="margin: 0 0 1px 0;width: 100%;padding-left: 2px;height: 25px;">
		                                                    <input type="checkbox" aria-label="..."
		                                                    name="billing_address[{{ field.field_name }}][]"
		                                                    value="{{ option.op_value }}"
		                                                    {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}
		                                                    >
		                                                    {{ option.op_name }}
		                                                </label><br>
		                                            {% endfor %}
		                                        {% endif %}
		                                        <input type="hidden" id="{{ field.field_id }}">
		                                    </div>
							  		</p>
							  	</div>

						  {% elseif (field['field_input_type'] == 'file' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p><input type="file"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  value=""
							                  id="{{ field['field_id'] }}"
							                  class="form-control"
							                  accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf" />
							  		</p>
							  	</div>

						  	{% elseif (field['field_input_type'] == 'image' and (field['field_existance'] != 'default') and ( field['field_to_show'] == 0 or 3 in field['field_to_show']) ) %}

						  		<div class="col-sm-12" style="width:{{ field.field_width }}%">
							  		<p><strong>{{ field['field_label'] }} {{ (field['field_condition'] == 'required') ? '<span style="color:red;">*</span>' : '' }}</strong></p>
							  		<p><input type="file"
							                  name="{{ (field['field_existance'] == 'default') ? field['field_name'] : 'billing_address[' ~ field['field_name'] ~ ']' }}"
							                  value=""
							                  id="{{ field['field_id'] }}" class="form-control"
							                  accept="image/*" />
							  		</p>
							  	</div>
						  	{% endif %}
						{% endfor %}
					{% endif %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<input type="button" value="{{ button_continue }}" id="button-shipping-method" data-loading-text="{{ text_loading }}" class="btn btn-primary" />]]></search>
	            <add position="after" offset="2"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
					<script type="text/javascript"><!--
						$('.date').datetimepicker({
							pickTime: false
						});

						$('.time').datetimepicker({
							pickDate: false
						});

						$('.datetime').datetimepicker({
							pickDate: true,
							pickTime: true
						});
					//--></script>
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>


	    <!-- MAIL / ORDER ADD - VIEW -->
	    <file path="catalog/view/theme/*/template/mail/order_add.twig">
	        <operation>
	            <search><![CDATA[<b>{{ text_payment_method }}</b> {{ payment_method }}<br />]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Modified By Extendons - Checkout Manager -->
					<div style="margin-bottom: 5px;"><b>{{ text_payment_method }}</b> {{ payment_method }}</div>
	                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}

		                {% if (additional_custom_fields_info['Payment Method Custom Fields'] is defined and additional_custom_fields_info['Payment Method Custom Fields'] is not empty) %}
		                    <table style="border-collapse: collapse; width: 100%; border-top: 1px solid #DDDDDD; border-left: 1px solid #DDDDDD; margin-bottom: 20px;">
		                        <thead>
		                            <tr><td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;" colspan="2">{{ 'Payment Method Custom Fields' }}</td></tr>
		                        </thead>
		                        <tbody>
		                            <tr><td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">
		                                {% for result in additional_custom_fields_info['Payment Method Custom Fields'] %}
		                                    {% if result is not empty %}
		                                        <b>{{ result['meta_key'] }}:</b>
	                                            {% if result['meta_value'] is iterable %}
	                                                    {% for val in result['meta_value'] %}
	                                                        {{ val|capitalize ~ ', ' }}
	                                                    {% endfor %}
	                                            {% else %}
	                                                    {{ result['meta_value']|capitalize }}
	                                            {% endif %}
	                                            <br />
		                                    {% endif %}
		                                {% endfor %}
		                            </td></tr>
		                        </tbody>
		                    </table>
		                {% endif %}
	                {% endif %}
				<!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[{% if shipping_method %} <b>{{ text_shipping_method }}</b> {{ shipping_method }}]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Modified By Extendons - Checkout Manager -->
	                {% if shipping_method or (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
					    {% if shipping_method %}
	                        <div style="margin-bottom: 5px;margin-top: 5px;"><b>{{ text_shipping_method }}</b> {{ shipping_method }}</div>
	                    {% endif %}

		                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}

			                {% if (additional_custom_fields_info['Shipping Method Custom Fields'] and additional_custom_fields_info['Shipping Method Custom Fields'] is not empty) %}
			                    <table style="border-collapse: collapse; width: 100%; border-top: 1px solid #DDDDDD; border-left: 1px solid #DDDDDD; margin-bottom: 20px;">
			                        <thead>
			                            <tr><td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;" colspan="2">{{ 'Shipping Method Custom Fields' }}</td></tr>
			                        </thead>
			                        <tbody>
			                            <tr><td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">
			                                {% for result in additional_custom_fields_info['Shipping Method Custom Fields'] %}
			                                    {% if result is not empty %}
			                                        <b>{{ result['meta_key'] }}:</b>
	                                                {% if result['meta_value'] is iterable %}
	                                                        {% for val in result['meta_value'] %}
	                                                            {{ val|capitalize ~ ', ' }}
	                                                        {% endfor %}
	                                                {% else %}
	                                                        {{ result['meta_value']|capitalize }}
	                                                {% endif %}
	                                                <br />
			                                    {% endif %}
			                                {% endfor %}
			                            </td></tr>
			                        </tbody>
			                    </table>
			                {% endif %}
		                {% endif %}
				<!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">{{ payment_address }}</td>]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Modified By Extendons - Checkout Manager -->
	            	<td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;"><div style="margin-bottom: 10px;">{{ payment_address }}</div>

		                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
			                {% if (additional_custom_fields_info['Payment Address Custom Fields'] and additional_custom_fields_info['Payment Address Custom Fields'] is not empty) %}
		                        <table style="border-collapse: collapse; width: 100%; border-top: 1px solid #DDDDDD; border-left: 1px solid #DDDDDD; margin-bottom: 20px;">
		                            <thead>
		                                <tr><td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;">{{ 'Payment Address Custom Fields' }}</td></tr>
		                            </thead>
		                            <tbody>
		                                <tr><td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">
		                                    {% for result in additional_custom_fields_info['Payment Address Custom Fields'] %}
		                                        {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
		                                        {% endif %}
		                                    {% endfor %}
		                                </td></tr>
		                            </tbody>
		                        </table>
			                {% endif %}
		                {% endif %}
		            </td>
				<!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="1"><![CDATA[{% if shipping_address %}]]></search>
	            <add position="replace" offset="1"><![CDATA[
	            <!-- Modified By Extendons - Checkout Manager -->
					{% if (shipping_address or (additional_custom_fields_info is defined and additional_custom_fields_info is not empty)) %}
						<td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">
	                        {% if (shipping_address) %}
	                            <div style="margin-bottom: 10px;">{{ shipping_address }}</div>
	                        {% endif %}
	                        {% if (additional_custom_fields_info['Shipping Address Custom Fields'] is defined and additional_custom_fields_info['Shipping Address Custom Fields'] is not empty) %}

		                        <table style="border-collapse: collapse; width: 100%; border-top: 1px solid #DDDDDD; border-left: 1px solid #DDDDDD; margin-bottom: 20px;">
		                            <thead>
		                                <tr><td style="font-size: 12px; border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; background-color: #EFEFEF; font-weight: bold; text-align: left; padding: 7px; color: #222222;">{{ 'Shipping Address Custom Fields' }}</td></tr>
		                            </thead>
		                            <tbody>
		                                <tr><td style="font-size: 12px;	border-right: 1px solid #DDDDDD; border-bottom: 1px solid #DDDDDD; text-align: left; padding: 7px;">
		                                    {% for result in additional_custom_fields_info['Shipping Address Custom Fields'] %}
		                                        {% if result is not empty %}
	                                                    <b>{{ result['meta_key'] }} : </b>
	                                                    {% if result['meta_value'] is iterable %}
	                                                            {% for val in result['meta_value'] %}
	                                                                {{ val|capitalize ~ ', ' }}
	                                                            {% endfor %}
	                                                    {% else %}
	                                                            {{ result['meta_value']|capitalize }}
	                                                    {% endif %}
	                                                    <br />
		                                        {% endif %}
		                                    {% endfor %}
		                                </td></tr>
		                            </tbody>
		                        </table>
	                        {% endif %}
	                    </td>
				<!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ACCOUNT / ORDER INFO - VIEW -->
	    <file path="catalog/view/theme/*/template/account/order_info.twig">
	        <operation>
	            <search><![CDATA[<td class="text-left" style="width: 50%;">{% if payment_method %} <b>{{ text_payment_method }}</b> {{ payment_method }}<br />]]></search>
	            <add position="replace"><![CDATA[
		        <!-- Extendons - Checkout Manager -->
		            <td class="text-left" style="width: 50%;">{% if payment_method %} <div style="margin-bottom: 10px;"><b>{{ text_payment_method }}</b> {{ payment_method }}</div>

		                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}

		                	{% if (additional_custom_fields_info['Payment Method Custom Fields'] is defined and additional_custom_fields_info['Payment Method Custom Fields'] is not empty) %}

		                            <table class="table table-bordered">
		                                <thead>
		                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Payment Method Custom Fields' }}</td></tr>
		                                </thead>
		                                <tbody>
		                                    <tr><td>
		                                        {% for result in additional_custom_fields_info['Payment Method Custom Fields'] %}
		                                            {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
		                                            {% endif %}
		                                        {% endfor %}
		                                    </td></tr>
		                                </tbody>
		                            </table>
		                    {% endif %}
		                {% endif %}
		        <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[{% if shipping_method %} <b>{{ text_shipping_method }}</b> {{ shipping_method }} {% endif %}</td>]]></search>
	            <add position="replace"><![CDATA[
		            <!-- Extendons - Checkout Manager -->
		            {% if shipping_method %}
		                <div style="margin-bottom: 10px;"><b>{{ text_shipping_method }}</b> {{ shipping_method }}</div>

	                    {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}
	                    	{% if (additional_custom_fields_info['Shipping Method Custom Fields'] is defined and additional_custom_fields_info['Shipping Method Custom Fields'] is not empty) %}

	                                <table class="table table-bordered">
	                                    <thead>
	                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Shipping Method Custom Fields' }}</td></tr>
	                                    </thead>
	                                    <tbody>
	                                        <tr><td>
	                                            {% for result in additional_custom_fields_info['Shipping Method Custom Fields'] %}
	                                                {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
	                                                {% endif %}
	                                            {% endfor %}
	                                        </td></tr>
	                                    </tbody>
	                                </table>
	                        {% endif %}
	                    {% endif %}
	                 {% endif %}</td>
		            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<td class="text-left">{{ payment_address }}</td>]]></search>
	            <add position="replace"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                <td class="text-left"><div style="margin-bottom: 10px;">{{ payment_address }}</div>

		                {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}

		                	{% if (additional_custom_fields_info['Payment Address Custom Fields'] is defined and additional_custom_fields_info['Payment Address Custom Fields'] is not empty) %}

		                            <table class="table table-bordered">
		                                <thead>
		                                    <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Payment Address Custom Fields' }}</td></tr>
		                                </thead>
			                            <tbody>
			                                <tr><td>
		                                        {% for result in additional_custom_fields_info['Payment Address Custom Fields'] %}
		                                            {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
		                                            {% endif %}
		                                        {% endfor %}
		                                    </td></tr>
			                            </tbody>
		                            </table>
	                        {% endif %}
		                {% endif %}
		            </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search index="1"><![CDATA[{% if shipping_address %}]]></search>
	            <add position="replace" offset="1"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                {% if shipping_address %}
		                <td class="text-left"><div style="margin-bottom: 10px;">{{ shipping_address }}</div>

		                    {% if (additional_custom_fields_info is defined and additional_custom_fields_info is not empty) %}

		                    	{% if (additional_custom_fields_info['Shipping Address Custom Fields'] is defined and additional_custom_fields_info['Shipping Address Custom Fields'] is not empty) %}

		                                <table class="table table-bordered">
		                                    <thead>
		                                        <tr><td class="text-left" colspan="2" style="width: 50%; vertical-align: top;">{{ 'Shipping Address Custom Fields' }}</td></tr>
		                                    </thead>
		                                    <tbody>
		                                        <tr><td>
		                                            {% for result in additional_custom_fields_info['Shipping Address Custom Fields'] %}
		                                                {% if result is not empty %}
		                                                    <b>{{ result['meta_key'] }} : </b>
		                                                    {% if result['meta_value'] is iterable %}
		                                                            {% for val in result['meta_value'] %}
		                                                                {{ val|capitalize ~ ', ' }}
		                                                            {% endfor %}
		                                                    {% else %}
		                                                            {{ result['meta_value']|capitalize }}
		                                                    {% endif %}
		                                                    <br />
		                                                {% endif %}
		                                            {% endfor %}
		                                        </td></tr>
		                                    </tbody>
		                                </table>
		                        {% endif %}
			            	{% endif %}
		                </td>
	            <!-- Extendons - Checkout Manager /- End -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ACCOUNT REGISTER / SIGNUP - VIEW -->
	    <file path="catalog/view/theme/*/template/account/register.twig">

	    	<!-- replace first 4 fields -->
	        <operation>
	            <search index="0"><![CDATA[<div class="form-group required">]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	            	{% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'text' and (5 in field.field_to_show) %}

			                    {% if field.field_name == 'firstname' or field.field_name == 'lastname' or field.field_name == 'email' or field.field_name == 'telephone' %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
			                            <div class="form-group {{ field.field_condition }}">
			                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="col-sm-10">

			                                    <input
			                                    	{% if field.field_name == 'email' %}
	                                            		type="email"
			                                    	{% else %}
	                                            		type="text"
			                                    	{% endif %}
			                                        name="{{ field.field_name }}"
			                                        value="{{ cf[field.field_name] }}"
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />

			                                	<!-- error text -->
			                                    {% if error is defined %}
				                                    {% for key, value in error %}
				                                        {% if value is not empty %}
				                                            {% set k = key|split('error_') %}
				                                            {% if k[1] == field.field_name %}
				                                                <div class="text-danger">{{ value }}</div>
				                                            {% endif %}
				                                        {% endif %}
				                                    {% endfor %}
				                                {% endif %}
			                            	</div>
			                            </div>
			                    	{% endif %}
			                    {% endif %}
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>

	        <operation>
	            <search><![CDATA[<legend>{{ text_your_password }}</legend>]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	                {% if my_custom_input_fields %}
			            {% for field in my_custom_input_fields %}
			                {% if field.field_input_type == 'password' and (5 in field.field_to_show) %}
			                    {% if field.field_name == 'password' or field.field_name == 'confirm' %}

			                            <div class="form-group {{ field.field_condition }}">
			                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                                <div class="col-sm-10">
			                                    <input
			                                        type="password"
			                                        name="{{ field.field_name }}"
			                                        value=""
			                                        placeholder="{{ field.field_placeholder }}"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                    />
                                             {% if field.field_name == 'confirm' %}
                                                <p class="pass-account">{{error_confirm_pass}}</p>
                                             {% endif %}
			                                	<!-- error text -->
			                                    {% if error is defined %}
				                                    {% for key, value in error %}
				                                        {% if value is not empty %}
				                                            {% set k = key|split('error_') %}
				                                            {% if k[1] == field.field_name %}
				                                                <div class="text-danger">{{ value }}</div>
				                                            {% endif %}
				                                        {% endif %}
				                                    {% endfor %}
				                                {% endif %}
			                            	</div>
			                            </div>
			                    {% endif %}
			                {% endif %}
			            {% endfor %}
			        {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	        <operation>
	            <search index="1"><![CDATA[</fieldset>]]></search>
	            <add position="after"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>

	    <!-- ACCOUNT ADDRESS FORM - VIEW -->
	    <file path="catalog/view/theme/*/template/account/address_form.twig">

	        <operation>
	            <search><![CDATA[<fieldset>]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
	            	<!-- when you insert new address, this below code will run -->
		            {% if my_input_fields is defined and my_input_fields is not empty %}
		                {% for field in my_input_fields %}

		                    {% if field.field_input_type == 'text' and (8 in field.field_to_show) %}
				                {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}
			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
				                    	<div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <input
				                                	type="text"
				                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value=""
				                                    placeholder="{{ field.field_placeholder }}"
				                                    id="{{ field.field_id }}"
				                                    class="form-control"
						                            {{ (field.field_condition == 'required') ? 'required' : '' }} />
				                            </div>
				                        </div>
			                        {% endif %}
		                        {% endif %} {% endif %}

		                    {% elseif field.field_input_type == 'date' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group date" >
			                                    <input type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'time' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group time" >
			                                    <input type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="HH:mm"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'datetime' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group datetime">
			                                    <input type="text"
			                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        value=""
			                                        placeholder="YYYY-MM-DD HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD HH:mm"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'textarea' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <textarea cols="3"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
		                                    placeholder="{{ field.field_placeholder }}"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
		                                ></textarea>
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'radio' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                    <!-- send required condition in hidden field -->
		                                    {% if (field.field_condition == 'required') %}
		                                        <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                    {% endif %}
					                        {% if field.field_options is not empty %}
						                        {% for option in field.field_options %}
						                        		<label class="radio-inline">
							                                <input type="radio"
							                                    name="billing_address[{{ field.field_name }}]"
							                                    value="{{ option.op_value }}"
							                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
							                                />
							                                {{ option.op_name }}
							                            </label>
						                        {% endfor %}
					                        {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'checkbox' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <!-- send hidden value, when checkbox has not been checked and is required, this is because when checkbox is required and it is not checked, then it doesn't send even name of the checkbox field to controller to check validation -->
		                                {% if (field.field_condition == 'required') %}
		                                    <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                {% endif %}
				                        {% if field.field_options is not empty %}
					                        {% for option in field.field_options %}
					                        		<label class="checkbox-inline">
						                                <input type="checkbox"
						                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]"
						                                    value="{{ option.op_value }}"
						                                    {{ (option['default_value'] == 'selected') ? 'checked="checked"' : '' }}
						                                />
						                                {{ option.op_name }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'select' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <select
		                                	name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                	id="{{ field.field_id }}"
		                                	class="form-control"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }} >
		                                    <!-- here is the default fields of country, zone etc -->
		                                    {% if (field.field_name == 'country_id') %}
		                                        <option value="">{{ text_select }}</option>
		                                        {% for country in countries %}
		                                            {% if (country['country_id'] == country_id) %}
		                                                <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
		                                            {% else %}
		                                                <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
		                                            {% endif %}
		                                        {% endfor %}
		                                    {% else %}
							                        {% if field.field_options is not empty %}
								                        {% for option in field.field_options %}
									                            <option value="{{ option.op_value }}" {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}>{{ option.op_name }}</option>
								                        {% endfor %}
							                        {% endif %}
		                                    {% endif %}
		                                </select>
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'multi-select' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <select
		                                    multiple="multiple"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]"
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }} >
					                        {% if field.field_options is not empty %}
						                        {% for option in field.field_options %}
							                            <option value="{{ option.op_value }}" {{ (option['default_value'] == 'selected') ? 'selected="selected"' : '' }}>{{ option.op_name }}</option>
						                        {% endfor %}
					                        {% endif %}
		                                </select>
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'file' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <input type="file"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                    value=""
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
		                                    accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }} />
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'image' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <input type="file"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                    value=""
		                                    placeholder="{{ field.field_placeholder }}"
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
		                                    accept="image/*"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }} />
		                            </div>
		                        </div>
		                    {% endif %}
		                {% endfor %}

		            <!-- when you edit existing address, this code will run -->
		            {% elseif (update_my_custom_address is defined and update_my_custom_address is not empty) %}

		                {% for field in update_my_custom_address %}

		                        {% if field.field_input_type == 'text' and (8 in field.field_to_show) %}
				                	{% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}
				                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
				                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
				                        {% else %}
		                                    <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                        <div class="col-sm-10">
		                                            <input type="text"
		                                                name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                                {% if field.my_custom_address is defined %}
		                                                    {% for f_key, f_val in field.my_custom_address %}
		                                                        {% if (field.field_name == f_key) %}
		                                                            value="{{ f_val }}"
		                                                        {% elseif (f_key == 'meta_address') %}
		                                                            {% if (f_val.meta_key is defined) %}
		                                                                {% if (field.field_name == f_val.meta_key) %}
		                                                                    value="{{ f_val.meta_value }}"
		                                                                {% endif %}
		                                                            {% endif %}
		                                                        {% endif %}
		                                                    {% endfor %}
		                                                {% elseif registered_address_before_module is defined %}
		                                                    {% for f_key, f_val in registered_address_before_module %}
		                                                        {% if (field.field_name == f_key) %}
		                                                            value="{{ f_val }}"
		                                                        {% endif %}
		                                                    {% endfor %}
		                                                {% endif %}
		                                                placeholder="{{ field.field_placeholder }}"
		                                                id="{{ field.field_id }}"
		                                                class="form-control"
		                                                {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            			{{ (field.field_condition == 'required') ? 'required' : '' }} />
		                                        </div>
		                                    </div>
		                                {% endif %}
	                                {% endif %} {% endif %}

		                        {% elseif field.field_input_type == 'date' and (8 in field.field_to_show) %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <div class="input-group date" >
		                                            <input type="text"
		                                                name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                                {% if field.my_custom_address is defined %}
		                                                    {% for f_key, f_val in field.my_custom_address %}
		                                                        {% if (field.field_name == f_key) %}
		                                                            value="{{ f_val }}"
		                                                        {% elseif (f_key == 'meta_address') %}
		                                                            {% if f_val.meta_key is defined %}
		                                                                {% if (field.field_name == f_val.meta_key) %}
		                                                                    value="{{ f_val.meta_value }}"
		                                                                {% endif %}
		                                                            {% endif %}
		                                                        {% endif %}
		                                                    {% endfor %}
		                                                {% endif %}
		                                                placeholder="YYYY-MM-DD"
		                                                id="{{ field.field_id }}"
		                                                class="form-control"
		                                                data-date-format="YYYY-MM-DD"
		                                                {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            			{{ (field.field_condition == 'required') ? 'required' : '' }}
		                                            /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                        </div>
		                                    </div>
		                                </div>
	                                {% endif %}

		                        {% elseif field.field_input_type == 'time' and (8 in field.field_to_show) %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <div class="input-group time" >
		                                            <input type="text"
		                                                name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                                {% if field.my_custom_address is defined %}
		                                                    {% for f_key, f_val in field.my_custom_address %}
		                                                        {% if (field.field_name == f_key) %}
		                                                            value="{{ f_val }}"
		                                                        {% elseif (f_key == 'meta_address') %}
		                                                            {% if f_val.meta_key is defined %}
		                                                                {% if (field.field_name == f_val.meta_key) %}
		                                                                    value="{{ f_val.meta_value }}"
		                                                                {% endif %}
		                                                            {% endif %}
		                                                        {% endif %}
		                                                    {% endfor %}
		                                                {% endif %}
		                                                placeholder="HH:mm"
		                                                id="{{ field.field_id }}"
		                                                class="form-control"
		                                                data-date-format="HH:mm"
		                                                {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            			{{ (field.field_condition == 'required') ? 'required' : '' }}
		                                            /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                        </div>
		                                    </div>
		                                </div>
	                                {% endif %}

		                        {% elseif field.field_input_type == 'datetime' and (8 in field.field_to_show) %}

			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <div class="input-group datetime" >
		                                            <input type="text"
		                                                name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                                {% if field.my_custom_address is defined %}
		                                                    {% for f_key, f_val in field.my_custom_address %}
		                                                        {% if (field.field_name == f_key) %}
		                                                            value="{{ f_val }}"
		                                                        {% elseif (f_key == 'meta_address') %}
		                                                            {% if f_val.meta_key is defined %}
		                                                                {% if (field.field_name == f_val.meta_key) %}
		                                                                    value="{{ f_val.meta_value }}"
		                                                                {% endif %}
		                                                            {% endif %}
		                                                        {% endif %}
		                                                    {% endfor %}
		                                                {% endif %}
		                                                placeholder="YYYY-MM-DD HH:mm"
		                                                id="{{ field.field_id }}"
		                                                class="form-control"
		                                                data-date-format="YYYY-MM-DD HH:mm"
		                                                {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            			{{ (field.field_condition == 'required') ? 'required' : '' }}
		                                            /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
		                                        </div>
		                                    </div>
		                                </div>
	                                {% endif %}

		                        {% elseif field.field_input_type == 'textarea' and (8 in field.field_to_show) %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <textarea rows="3" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" placeholder="{{ field.field_placeholder }}" class="form-control"
		                                            {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            		{{ (field.field_condition == 'required') ? 'required' : '' }}
		                                        >{% if field.my_custom_address is defined %}{% for f_key, f_val in field.my_custom_address %}{% if (field.field_name == f_key) %}{{ f_val }}{% elseif (f_key == 'meta_address') %}{% if f_val.meta_key is defined %}{% if (field.field_name == f_val.meta_key) %}{{ f_val.meta_value }}{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}</textarea>
		                                    </div>
		                                </div>

		                        {% elseif field.field_input_type == 'radio' and (8 in field.field_to_show) %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
						                        {% if field.field_options is not empty %}
							                        {% for option in field.field_options %}
							                        	<input type="{{ (field.field_visibility != 0 and 2 in field.field_visibility) ? 'hidden' : 'radio' }}"
		                                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                                    value="{{ option.op_value }}"
		                                                    {% if field.my_custom_address is defined %}
		                                                        {% for f_key, f_val in field.my_custom_address %}
		                                                            {% if (f_key == 'meta_address') %}
		                                                                {% if (field.field_name == f_val.meta_key and f_val.meta_value == option.op_value) %}
		                                                                    {{ 'checked="checked"' }}
		                                                                {% endif %}
		                                                            {% endif %}
		                                                        {% endfor %}
		                                                    {% endif %}
		                                                    {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
		                                                />
			                                            {{ option.op_name }}
		                                            {% endfor %}
		                                        {% endif %}
		                                    </div>
		                                </div>

		                        {% elseif field.field_input_type == 'checkbox' and (8 in field.field_to_show) %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">

		                                        <!-- send hidden value, when checkbox has not been checked and is required, this is because when checkbox is required and it is not checked, then it doesn't send even name of the checkbox field to controller to check validation -->
		                                        {% if (field.field_condition == 'required') %}
		                                            <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                        {% endif %}

						                        {% if field.field_options is not empty %}
							                        {% for option in field.field_options %}
				                                            <label class="checkbox-inline">
				                                                <input type="{{ (field.field_visibility != 0 and 2 in field.field_visibility) ? 'hidden' : 'checkbox' }}" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]" value="{{ option.op_value }}"
				                                                    {% if field.my_custom_address is defined %}
				                                                        {% for f_key, f_val in field.my_custom_address %}
				                                                            {% if (f_key == 'meta_address') %}
				                                                                {% if (f_val.meta_value is defined and f_val.meta_value is not empty) %}
				                                                                    {% for k, v in f_val.meta_value %}
				                                                                        {% if (v == option.op_value) %}
				                                                                            {{ 'checked="checked"' }}
				                                                                        {% endif %}
				                                                                    {% endfor %}
				                                                                {% endif %}
				                                                            {% endif %}
				                                                        {% endfor %}
				                                                    {% endif %}
				                                                    {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                                                />
				                                                {{ option.op_name }}
				                                            </label>
		                                            {% endfor %}
		                                        {% endif %}
		                                    </div>
		                                </div>

		                        {% elseif field.field_input_type == 'select' and (8 in field.field_to_show) %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <select
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            		{{ (field.field_condition == 'required') ? 'required' : '' }} >
		                                            <!-- here is the default fields of country, zone etc -->
		                                            {% if (field.field_name == 'country_id') %}
			                                                <option value="">{{ text_select }}</option>
			                                                {% for country in countries %}
			                                                    {% if (country['country_id'] == country_id) %}
			                                                        <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
			                                                    {% else %}
			                                                        <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
			                                                    {% endif %}
			                                                {% endfor %}
		                                            <!-- here is my custom created fields -->
		                                            {% else %}
									                        {% if field.field_options is not empty %}
										                        {% for option in field.field_options %}
				                                                    <option
				                                                        value="{{ option.op_value }}"
				                                                        {% if field.my_custom_address is defined %}
				                                                            {% for f_key, f_val in field.my_custom_address %}
				                                                                {% if (f_key == 'meta_address') %}
				                                                                        {% if (field.field_name == f_val.meta_key and f_val.meta_value == option.op_value) %}
				                                                                            {{ 'selected="selected"' }}
				                                                                        {% endif %}
				                                                                {% endif %}
				                                                            {% endfor %}
				                                                        {% endif %}
				                                                    >{{ option.op_name }}</option>
			                                                    {% endfor %}
			                                                {% endif %}
			                                        {% endif %}
		                                        </select>
		                                    </div>
		                                </div>

		                        {% elseif field.field_input_type == 'multi-select' and (8 in field.field_to_show) %}
		                                <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                    <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                    <div class="col-sm-10">
		                                        <select
		                                            multiple="multiple"
		                                            name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]"
		                                            id="{{ field.field_id }}"
		                                            class="form-control"
		                                            {{ ( field.field_visibility != 0 and 1 in field.field_visibility ) ? 'readonly="readonly"' : '' }}
				                            		{{ (field.field_condition == 'required') ? 'required' : '' }} >

							                        {% if field.field_options is not empty %}
								                        {% for option in field.field_options %}
				                                                <option
				                                                    value="{{ option.op_value }}"
				                                                    {% if field.my_custom_address is defined %}
				                                                        {% for f_key, f_val in field.my_custom_address %}
				                                                            {% if (f_key == 'meta_address') %}
				                                                                {% if (f_val.meta_value is defined and f_val.meta_value is not empty) %}
				                                                                    {% if (field.field_name == f_val.meta_key) %}
				                                                                        {% for k, v in f_val.meta_value %}
				                                                                            {% if (v == option.op_value) %}
				                                                                                {{ 'selected="selected"' }}
				                                                                            {% endif %}
				                                                                        {% endfor %}
				                                                                    {% endif %}
				                                                                {% endif %}
				                                                            {% endif %}
				                                                        {% endfor %}
				                                                    {% endif %}
			                                                    >
			                                                    	{{ option.op_name }}
			                                                    </option>
	                                                    {% endfor %}
	                                                {% endif %}
		                                        </select>
		                                    </div>
		                                </div>

		                        {% elseif field.field_input_type == 'file' and (8 in field.field_to_show) %}

		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <input type="file"
		                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                        value=""
		                                        id="{{ field.field_id }}"
		                                        class="form-control"
		                                        accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf"
				                            	{{ (field.field_condition == 'required') ? 'required' : '' }} />
		                                </div>
		                            </div>

		                        {% elseif field.field_input_type == 'image' and (8 in field.field_to_show) %}

		                            <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                                <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                                <div class="col-sm-10">
		                                    <input type="file"
		                                        name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                        value=""
		                                        placeholder="{{ field.field_placeholder }}"
		                                        id="{{ field.field_id }}"
		                                        class="form-control"
		                                        accept="image/*"
				                            	{{ (field.field_condition == 'required') ? 'required' : '' }} />
		                                </div>
		                            </div>
		                        {% endif %}
		                {% endfor %}

		            <!-- when you submit, and there is any error mean any empty field you are posting and this field is actually required field, then when the form is return, this below form will be shown -->
		            {% elseif (error_in_input_fields is defined and error_in_input_fields is not empty) %}
		                {% for field in error_in_input_fields %}

		                    {% if field.field_input_type == 'text' and (8 in field.field_to_show) %}
				                {% if field.field_name != 'email' %} {% if field.field_name != 'telephone' %}
			                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
			                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
			                        {% else %}
				                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
				                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
				                            <div class="col-sm-10">
				                                <input type="text" name="{{ field.field_name }}"
				                                    {% for key, value in input_keys %}
				                                        {% if (key == field.field_name) %}
				                                            value="{{ value }}"
				                                        {% endif %}
				                                    {% endfor %}
				                                    placeholder="{{ field.field_placeholder }}"
				                                    id="{{ field.field_id }}"
				                                    class="form-control"
				                                    {{ (field.field_visibility == 1) ? 'readonly="readonly"': '' }}
						                            {{ (field.field_condition == 'required') ? 'required' : '' }} />

					                                <!-- error text -->
					                                {% if error is defined %}
					                                    {% for key, value in error %}
					                                        {% if value is not empty %}
					                                            {% set k = key|split('error_') %}
					                                            {% if k[1] == field.field_name %}
					                                                <div class="text-danger">{{ value }}</div>
					                                            {% endif %}
					                                        {% endif %}
					                                    {% endfor %}
					                                {% endif %}
				                            </div>
				                        </div>
			                        {% endif %}
		                        {% endif %} {% endif %}

		                    {% elseif field.field_input_type == 'date' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group date" >
			                                    <input type="text" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        {% for key, value in input_keys %}
			                                            {% if (key == field.field_name) %}
			                                                value="{{ value }}"
			                                            {% endif %}
			                                        {% endfor %}
			                                        placeholder="YYYY-MM-DD"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>

				                                <!-- error text -->
				                                {% if error is defined %}
				                                    {% for key, value in error %}
				                                        {% if value is not empty %}
				                                            {% set k = key|split('error_') %}
				                                            {% if k[1] == field.field_name %}
				                                                <div class="text-danger">{{ value }}</div>
				                                            {% endif %}
				                                        {% endif %}
				                                    {% endfor %}
				                                {% endif %}
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'time' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group time" >
			                                    <input type="text" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        {% for key, value in input_keys %}
			                                            {% if (key == field.field_name) %}
			                                                value="{{ value }}"
			                                            {% endif %}
			                                        {% endfor %}
			                                        placeholder="HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="HH:mm"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>

				                                <!-- error text -->
				                                {% if error is defined %}
				                                    {% for key, value in error %}
				                                        {% if value is not empty %}
				                                            {% set k = key|split('error_') %}
				                                            {% if k[1] == field.field_name %}
				                                                <div class="text-danger">{{ value }}</div>
				                                            {% endif %}
				                                        {% endif %}
				                                    {% endfor %}
				                                {% endif %}
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'datetime' and (8 in field.field_to_show) %}

		                    	{% if (field.field_visibility != 0 and 2 in field.field_visibility) %}
		                    		<input type="hidden" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" value="" />
		                        {% else %}
			                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
			                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
			                            <div class="col-sm-10">
			                                <div class="input-group datetime" >
			                                    <input type="text" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
			                                        {% for key, value in input_keys %}
			                                            {% if (key == field.field_name) %}
			                                                value="{{ value }}"
			                                            {% endif %}
			                                        {% endfor %}
			                                        placeholder="YYYY-MM-DD HH:mm"
			                                        id="{{ field.field_id }}"
			                                        class="form-control"
			                                        data-date-format="YYYY-MM-DD HH:mm"
					                            	{{ (field.field_condition == 'required') ? 'required' : '' }}
			                                    /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
			                                </div>

				                                <!-- error text -->
				                                {% if error is defined %}
				                                    {% for key, value in error %}
				                                        {% if value is not empty %}
				                                            {% set k = key|split('error_') %}
				                                            {% if k[1] == field.field_name %}
				                                                <div class="text-danger">{{ value }}</div>
				                                            {% endif %}
				                                        {% endif %}
				                                    {% endfor %}
				                                {% endif %}
			                            </div>
			                        </div>
		                        {% endif %}

		                    {% elseif field.field_input_type == 'textarea' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <textarea cols="3" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" class="form-control" placeholder="{{ field.field_placeholder }}"
		                                    {{ (field.field_visibility == 1) ? 'readonly="readonly"': '' }}
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
		                                    >{% if input_keys is defined %}
		                                        {% for key, value in input_keys %}
		                                            {% if (key == field.field_name) %}
		                                                {{ value }}
		                                            {% endif %}
		                                        {% endfor %}
		                                    {% endif %}</textarea>

			                                <!-- error text -->
			                                {% if error is defined %}
			                                    {% for key, value in error %}
			                                        {% if value is not empty %}
			                                            {% set k = key|split('error_') %}
			                                            {% if k[1] == field.field_name %}
			                                                <div class="text-danger">{{ value }}</div>
			                                            {% endif %}
			                                        {% endif %}
			                                    {% endfor %}
			                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'radio' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">

		                                <!-- send required condition in hidden field -->
		                                {% if (field.field_condition == 'required') %}
		                                    <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                {% endif %}
				                        {% if field.field_options is not empty %}
					                        {% for option in field.field_options %}
					                        	<label class="radio-inline">
			                                        <input type="radio" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" value="{{ option.op_value }}"
			                                            {% if input_keys is defined %}
			                                                {% for key, value in input_keys %}
			                                                    {% if (key == field.field_name and value == option.op_value) %}
			                                                        {{ 'checked="checked"' }}
			                                                    {% endif %}
			                                                {% endfor %}
			                                            {% endif %}
			                                        />
			                                        {{ option.op_name }}
			                                    </label>
	                                        {% endfor %}
	                                    {% endif %}

			                                <!-- error text -->
			                                {% if error is defined %}
			                                    {% for key, value in error %}
			                                        {% if value is not empty %}
			                                            {% set k = key|split('error_') %}
			                                            {% if k[1] == field.field_name %}
			                                                <div class="text-danger">{{ value }}</div>
			                                            {% endif %}
			                                        {% endif %}
			                                    {% endfor %}
			                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'checkbox' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">

		                                <!-- send hidden value, when checkbox has not been checked and is required, this is because when checkbox is required and it is not checked, then it doesn't send even name of the checkbox field to controller to check validation -->
		                                {% if (field.field_condition == 'required') %}
		                                    <input type="hidden" name="billing_address[{{ field.field_name }}]" value="{{ field.field_condition }}">
		                                {% endif %}
				                        {% if field.field_options is not empty %}
					                        {% for option in field.field_options %}
					                        		<label class="checkbox-inline">
						                                <input type="checkbox" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]" value="{{ option.op_value }}"
		                                            		{{ (field.field_visibility == 1) ? 'readonly="readonly"': '' }}
						                                    {% if input_keys is defined and input_keys is not empty %}
				                                                {% for key, value in input_keys %}
				                                                    {% if key == field.field_name %}
				                                                        {% if value is iterable %}
				                                                            {% for k, v in value %}
				                                                                {{ (option.op_value == v) ? 'checked="checked"': '' }}
				                                                            {% endfor %}
				                                                        {% endif %}
				                                                    {% endif %}
				                                                {% endfor %}
				                                            {% endif %}
						                                />
						                                {{ option.op_name }}
						                            </label>
					                        {% endfor %}
				                        {% endif %}

		                                {% if error is defined %}
		                                    {% for key, value in error %}
		                                        {% if value is not empty %}
		                                            {% set k = key|split('error_') %}
		                                            {% if k[1] == field.field_name %}
		                                                <div class="text-danger">{{ value }}</div>
		                                            {% endif %}
		                                        {% endif %}
		                                    {% endfor %}
		                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'select' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <select name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}" id="{{ field.field_id }}" class="form-control"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
				                        >
		                                    {% if (field.field_name == 'country_id') %}
			                                        <option value="">{{ text_select }}</option>
			                                        {% for country in countries %}
			                                            {% if (country['country_id'] == country_id) %}
			                                                <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
			                                            {% else %}
			                                                <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
			                                            {% endif %}
			                                        {% endfor %}
		                                    {% else %}
							                        {% if field.field_options is not empty %}
								                        {% for option in field.field_options %}
								                            <option value="{{ option.op_value }}"
								                            	{% if input_keys is defined %}
				                                                    {% for key, val in input_keys %}
				                                                        {% if (key == field.field_name and val == option.op_value) %}
				                                                            {{ 'selected="selected"' }}
				                                                        {% endif %}
				                                                    {% endfor %}
				                                                {% endif %}
								                            >{{ option.op_name }}</option>
								                        {% endfor %}
							                        {% endif %}
			                                {% endif %}
		                                </select>

		                                {% if error is defined %}
		                                    {% for key, value in error %}
		                                        {% if value is not empty %}
		                                            {% set k = key|split('error_') %}
		                                            {% if k[1] == field.field_name %}
		                                                <div class="text-danger">{{ value }}</div>
		                                            {% endif %}
		                                        {% endif %}
		                                    {% endfor %}
		                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'multi-select' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <select multiple="multiple" name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}[]" id="{{ field.field_id }}" class="form-control"
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
		                                >
					                        {% if field.field_options is not empty %}
						                        {% for option in field.field_options %}
						                            <option value="{{ option.op_value }}"
						                            	{% if input_keys is defined %}
				                                                {% for key, value in input_keys %}
				                                                    {% if (key == field.field_name) %}
				                                                        {% for v in value %}
				                                                            {{ (option.op_value == v) ? 'selected="selected"': '' }}
				                                                        {% endfor %}
				                                                    {% endif %}
				                                                {% endfor %}
				                                        {% endif %}
						                            >{{ option.op_name }}</option>
						                        {% endfor %}
					                        {% endif %}
		                                </select>

		                                {% if error is defined %}
		                                    {% for key, value in error %}
		                                        {% if value is not empty %}
		                                            {% set k = key|split('error_') %}
		                                            {% if k[1] == field.field_name %}
		                                                <div class="text-danger">{{ value }}</div>
		                                            {% endif %}
		                                        {% endif %}
		                                    {% endfor %}
		                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'file' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <input type="file"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                    value=""
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
		                                    accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf"
		                                    {{ (field.field_visibility == 1) ? 'readonly="readonly"' : '' }}
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
		                                />

		                                {% if error is defined %}
		                                    {% for key, value in error %}
		                                        {% if value is not empty %}
		                                            {% set k = key|split('error_') %}
		                                            {% if k[1] == field.field_name %}
		                                                <div class="text-danger">{{ value }}</div>
		                                            {% endif %}
		                                        {% endif %}
		                                    {% endfor %}
		                                {% endif %}
		                            </div>
		                        </div>

		                    {% elseif field.field_input_type == 'image' and (8 in field.field_to_show) %}

		                        <div class="form-group col-sm-12 {{ field.field_condition }}" style="width:{{ field.field_width }}%">
		                            <label class="col-sm-2 control-label" for="{{ field.field_id }}">{{ field.field_label }}</label>
		                            <div class="col-sm-10">
		                                <input type="file"
		                                    name="{{ (field.field_existance == 'default') ? field.field_name : 'billing_address[' ~ field.field_name ~ ']' }}"
		                                    value=""
		                                    id="{{ field.field_id }}"
		                                    class="form-control"
		                                    accept="image/*"
		                                    {{ (field.field_visibility == 1) ? 'readonly="readonly"': '' }}
				                            {{ (field.field_condition == 'required') ? 'required' : '' }}
		                                />

		                                {% if error is defined %}
		                                    {% for key, value in error %}
		                                        {% if value is not empty %}
		                                            {% set k = key|split('error_') %}
		                                            {% if k[1] == field.field_name %}
		                                                <div class="text-danger">{{ value }}</div>
		                                            {% endif %}
		                                        {% endif %}
		                                    {% endfor %}
		                                {% endif %}
		                            </div>
		                        </div>
		                    {% endif %}
		                {% endfor %}

		            {% else %}
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    	<!-- modified & replaced - existing address form -->
	        <operation>
	            <search><![CDATA[{% for custom_field in custom_fields %}]]></search>
	            <add position="before"><![CDATA[
	            <!-- Extendons - Checkout Manager -->
				    {% endif %} <!-- end if(my_custom_input_fields) -->
	            <!-- Extendons - Checkout Manager /- END -->
		    	]]></add>
	        </operation>
	    </file>



</modification>
